# Web Planner 节点测试说明

## 测试文件

`test_web_planner.py` - 测试 `web_planner_node` 是否能正常生成网页规划

## 运行测试

在项目根目录下运行：

```bash
# 使用 uv 运行
uv run python test/test_web_planner.py

# 或使用 Python 直接运行
python test/test_web_planner.py
```

## 测试内容

该测试会验证以下内容：

1. **节点调用** - 验证 `web_planner_node` 能正常被调用
2. **模型调用** - 验证 reasoning 模型能正常生成响应
3. **计划生成** - 验证能成功生成 `WebPlan` 对象
4. **结构验证** - 验证计划包含：
   - `thought` (思考过程)
   - `title` (计划标题)
   - `steps` (执行步骤列表)
5. **步骤类型** - 验证步骤类型正确：
   - `source` - 资源型步骤
   - `document` - 文档型步骤
   - `codegen` - 代码生成型步骤
6. **路由验证** - 验证节点正确路由到 `code_team`

## 测试输出

测试会输出详细的执行过程，包括：

- 生成的计划标题
- 思考过程摘要
- 步骤数量和类型统计
- 每个步骤的详细信息

## 成功标准

测试通过需要满足：

✅ 成功调用 reasoning 模型  
✅ 生成有效的 JSON 响应  
✅ 解析为 WebPlan 对象  
✅ 包含至少 1 个步骤  
✅ 所有步骤类型合法  
✅ 正确路由到 code_team  

## 示例输出

```
🦌 DeerFlow - Web Planner 节点测试

============================================================
🧪 测试 web_planner_node - 网页生成规划器
============================================================

📋 步骤 1: 准备测试数据
✅ 测试 State 已创建
   用户需求: 帮我生成一个在线课程平台的网站，包含课程列表、课程详情、用户登录等功能

📋 步骤 2: 准备配置
✅ 配置已准备

📋 步骤 3: 调用 web_planner_node
⏳ 正在调用 reasoning 模型生成计划...

📋 步骤 4: 验证生成结果
✅ Command 对象结构正确
   路由目标: code_team
✅ 路由目标正确 (code_team)
✅ 生成的计划类型正确 (WebPlan)

📋 步骤 5: 检查计划内容
============================================================
📝 生成的网页规划详情:
============================================================

💭 思考过程:
   用户需要一个在线课程平台，核心功能包括课程展示、详情查看和用户登录...

📌 计划标题: 在线课程平台网站生成计划

📋 步骤数量: 5 个

📊 步骤类型统计:
   - source: 1 个
   - document: 1 个
   - codegen: 3 个

============================================================
🎉 测试通过！web_planner_node 工作正常
============================================================
```

## 注意事项

- 确保 `config.yaml` 中配置了有效的 reasoning 模型
- 测试需要网络连接以调用 LLM API
- 首次运行可能需要较长时间，因为需要调用 reasoning 模型
