{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/lib/utils.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAE/B;AACA;;;AAEO,SAAS;IAAG,IAAA,IAAA,OAAA,UAAA,QAAA,AAAG,SAAH,UAAA,OAAA,OAAA,GAAA,OAAA,MAAA;QAAG,OAAH,QAAA,SAAA,CAAA,KAAuB;;IACxC,OAAO,CAAA,GAAA,4NAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,yLAAA,CAAA,OAAI,AAAD,EAAE;AACtB","debugId":null}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/button.tsx"],"sourcesContent":["import { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport * as React from \"react\";\n\nimport { cn } from \"~/lib/utils\";\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n);\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean;\n  }) {\n  const Comp = asChild ? Slot : \"button\";\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(\n        buttonVariants({ variant, size, className }),\n        \"cursor-pointer active:scale-105\",\n      )}\n      {...props}\n    />\n  );\n}\n\nexport { Button, buttonVariants };\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAGA;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,8OAAA,CAAA,MAAG,AAAD,EACvB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,KASb;QATa,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF,GATa;IAUd,MAAM,OAAO,UAAU,uSAAA,CAAA,OAAI,GAAG;IAE9B,qBACE,sYAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,eAAe;YAAE;YAAS;YAAM;QAAU,IAC1C;QAED,GAAG,KAAK;;;;;;AAGf;KAtBS","debugId":null}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/deer-flow/logo.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport Link from \"next/link\";\n\nexport function Logo() {\n  return (\n    <Link\n      className=\"opacity-70 transition-opacity duration-300 hover:opacity-100\"\n      href=\"/\"\n    >\n      ðŸ“º DeepCraft\n    </Link>\n  );\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;AAE/B;;;AAEO,SAAS;IACd,qBACE,sYAAC,wWAAA,CAAA,UAAI;QACH,WAAU;QACV,MAAK;kBACN;;;;;;AAIL;KATgB","debugId":null}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/tooltip.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\n\"use client\";\n\nimport * as React from \"react\";\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\";\n\nimport { cn } from \"~/lib/utils\";\n\nfunction TooltipProvider({\n  delayDuration = 0,\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {\n  return (\n    <TooltipPrimitive.Provider\n      data-slot=\"tooltip-provider\"\n      delayDuration={delayDuration}\n      {...props}\n    />\n  );\n}\n\nfunction Tooltip({\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Root>) {\n  return (\n    <TooltipProvider>\n      <TooltipPrimitive.Root data-slot=\"tooltip\" {...props} />\n    </TooltipProvider>\n  );\n}\n\nfunction TooltipTrigger({\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {\n  return <TooltipPrimitive.Trigger data-slot=\"tooltip-trigger\" {...props} />;\n}\n\nfunction TooltipContent({\n  className,\n  sideOffset = 0,\n  children,\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Content>) {\n  return (\n    <TooltipPrimitive.Portal>\n      <TooltipPrimitive.Content\n        data-slot=\"tooltip-content\"\n        sideOffset={sideOffset}\n        className={cn(\n          \"bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance\",\n          className,\n        )}\n        {...props}\n      >\n        {children}\n        <TooltipPrimitive.Arrow className=\"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]\" />\n      </TooltipPrimitive.Content>\n    </TooltipPrimitive.Portal>\n  );\n}\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;;;;AAK/B;AAEA;AALA;;;;AAOA,SAAS,gBAAgB,KAGgC;QAHhC,EACvB,gBAAgB,CAAC,EACjB,GAAG,OACoD,GAHhC;IAIvB,qBACE,sYAAC,uXAAA,CAAA,WAAyB;QACxB,aAAU;QACV,eAAe;QACd,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,QAAQ,KAEoC;QAFpC,EACf,GAAG,OACgD,GAFpC;IAGf,qBACE,sYAAC;kBACC,cAAA,sYAAC,uXAAA,CAAA,OAAqB;YAAC,aAAU;YAAW,GAAG,KAAK;;;;;;;;;;;AAG1D;MARS;AAUT,SAAS,eAAe,KAEgC;QAFhC,EACtB,GAAG,OACmD,GAFhC;IAGtB,qBAAO,sYAAC,uXAAA,CAAA,UAAwB;QAAC,aAAU;QAAmB,GAAG,KAAK;;;;;;AACxE;MAJS;AAMT,SAAS,eAAe,KAKgC;QALhC,EACtB,SAAS,EACT,aAAa,CAAC,EACd,QAAQ,EACR,GAAG,OACmD,GALhC;IAMtB,qBACE,sYAAC,uXAAA,CAAA,SAAuB;kBACtB,cAAA,sYAAC,uXAAA,CAAA,UAAwB;YACvB,aAAU;YACV,YAAY;YACZ,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,0aACA;YAED,GAAG,KAAK;;gBAER;8BACD,sYAAC,uXAAA,CAAA,QAAsB;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAI1C;MAtBS","debugId":null}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/deer-flow/tooltip.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport type { CSSProperties } from \"react\";\n\nimport {\n  Tooltip as ShadcnTooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"~/components/ui/tooltip\";\nimport { cn } from \"~/lib/utils\";\n\nexport function Tooltip({\n  className,\n  style,\n  children,\n  title,\n  open,\n  side,\n  sideOffset,\n  delayDuration = 750,\n}: {\n  className?: string;\n  style?: CSSProperties;\n  children: React.ReactNode;\n  title?: React.ReactNode;\n  open?: boolean;\n  side?: \"left\" | \"right\" | \"top\" | \"bottom\";\n  sideOffset?: number;\n  delayDuration?: number;\n}) {\n  return (\n    <TooltipProvider>\n      <ShadcnTooltip delayDuration={delayDuration} open={open}>\n        <TooltipTrigger asChild>{children}</TooltipTrigger>\n        <TooltipContent\n          className={cn(className)}\n          style={style}\n          side={side}\n          sideOffset={sideOffset}\n        >\n          {title}\n        </TooltipContent>\n      </ShadcnTooltip>\n    </TooltipProvider>\n  );\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;AAI/B;AAMA;;;;AAEO,SAAS,QAAQ,KAkBvB;QAlBuB,EACtB,SAAS,EACT,KAAK,EACL,QAAQ,EACR,KAAK,EACL,IAAI,EACJ,IAAI,EACJ,UAAU,EACV,gBAAgB,GAAG,EAUpB,GAlBuB;IAmBtB,qBACE,sYAAC,sIAAA,CAAA,kBAAe;kBACd,cAAA,sYAAC,sIAAA,CAAA,UAAa;YAAC,eAAe;YAAe,MAAM;;8BACjD,sYAAC,sIAAA,CAAA,iBAAc;oBAAC,OAAO;8BAAE;;;;;;8BACzB,sYAAC,sIAAA,CAAA,iBAAc;oBACb,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE;oBACd,OAAO;oBACP,MAAM;oBACN,YAAY;8BAEX;;;;;;;;;;;;;;;;;AAKX;KAlCgB","debugId":null}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/deer-flow/theme-toggle.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\n\"use client\";\n\nimport { Monitor, Moon, Sun } from \"lucide-react\";\nimport { useTheme } from \"next-themes\";\n\nimport { Button } from \"~/components/ui/button\";\nimport { cn } from \"~/lib/utils\";\n\nimport { Tooltip } from \"./tooltip\";\n\nexport function ThemeToggle() {\n  const { resolvedTheme = \"dark\", setTheme } = useTheme();\n  const isDarkMode = resolvedTheme === \"dark\";\n\n  return (\n    <Tooltip title=\"Change theme\">\n      <Button\n        variant=\"ghost\"\n        size=\"icon\"\n        onClick={() => setTheme(isDarkMode ? \"light\" : \"dark\")}\n        aria-label=\"Toggle theme\"\n      >\n        <Sun className=\"h-[1.2rem] w-[1.2rem] scale-100 rotate-0 transition-all dark:scale-0 dark:-rotate-90\" />\n        <Moon className=\"absolute h-[1.2rem] w-[1.2rem] scale-0 rotate-90 transition-all dark:scale-100 dark:rotate-0\" />\n      </Button>\n    </Tooltip>\n  );\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;AAI/B;AAAA;AACA;AAEA;AAGA;;;AARA;;;;;AAUO,SAAS;;IACd,MAAM,EAAE,gBAAgB,MAAM,EAAE,QAAQ,EAAE,GAAG,CAAA,GAAA,2RAAA,CAAA,WAAQ,AAAD;IACpD,MAAM,aAAa,kBAAkB;IAErC,qBACE,sYAAC,gJAAA,CAAA,UAAO;QAAC,OAAM;kBACb,cAAA,sYAAC,qIAAA,CAAA,SAAM;YACL,SAAQ;YACR,MAAK;YACL,SAAS,IAAM,SAAS,aAAa,UAAU;YAC/C,cAAW;;8BAEX,sYAAC,uRAAA,CAAA,MAAG;oBAAC,WAAU;;;;;;8BACf,sYAAC,yRAAA,CAAA,OAAI;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAIxB;GAjBgB;;QAC+B,2RAAA,CAAA,WAAQ;;;KADvC","debugId":null}},
    {"offset": {"line": 364, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"~/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,8OAAA,CAAA,MAAG,AAAD,EACtB,kZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,KAM6C;QAN7C,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD,GAN7C;IAOb,MAAM,OAAO,UAAU,uSAAA,CAAA,OAAI,GAAG;IAE9B,qBACE,sYAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAhBS","debugId":null}},
    {"offset": {"line": 417, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { XIcon } from \"lucide-react\"\n\nimport { cn } from \"~/lib/utils\"\n\nfunction Dialog({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\n}\n\nfunction DialogTrigger({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\n}\n\nfunction DialogPortal({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\n}\n\nfunction DialogClose({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\n}\n\nfunction DialogOverlay({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\n  return (\n    <DialogPrimitive.Overlay\n      data-slot=\"dialog-overlay\"\n      className={cn(\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogContent({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Content>) {\n  return (\n    <DialogPortal data-slot=\"dialog-portal\">\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        data-slot=\"dialog-content\"\n        className={cn(\n          \"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n        <DialogPrimitive.Close className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\">\n          <XIcon />\n          <span className=\"sr-only\">Close</span>\n        </DialogPrimitive.Close>\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  )\n}\n\nfunction DialogHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"dialog-header\"\n      className={cn(\"flex flex-col gap-2 text-center sm:text-left\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"dialog-footer\"\n      className={cn(\n        \"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogTitle({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\n  return (\n    <DialogPrimitive.Title\n      data-slot=\"dialog-title\"\n      className={cn(\"text-lg leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\n  return (\n    <DialogPrimitive.Description\n      data-slot=\"dialog-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,KAEoC;QAFpC,EACd,GAAG,OAC+C,GAFpC;IAGd,qBAAO,sYAAC,sXAAA,CAAA,OAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,cAAc,KAEgC;QAFhC,EACrB,GAAG,OACkD,GAFhC;IAGrB,qBAAO,sYAAC,sXAAA,CAAA,UAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;MAJS;AAMT,SAAS,aAAa,KAEgC;QAFhC,EACpB,GAAG,OACiD,GAFhC;IAGpB,qBAAO,sYAAC,sXAAA,CAAA,SAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;MAJS;AAMT,SAAS,YAAY,KAEgC;QAFhC,EACnB,GAAG,OACgD,GAFhC;IAGnB,qBAAO,sYAAC,sXAAA,CAAA,QAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,KAGgC;QAHhC,EACrB,SAAS,EACT,GAAG,OACkD,GAHhC;IAIrB,qBACE,sYAAC,sXAAA,CAAA,UAAuB;QACtB,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,cAAc,KAIgC;QAJhC,EACrB,SAAS,EACT,QAAQ,EACR,GAAG,OACkD,GAJhC;IAKrB,qBACE,sYAAC;QAAa,aAAU;;0BACtB,sYAAC;;;;;0BACD,sYAAC,sXAAA,CAAA,UAAuB;gBACtB,aAAU;gBACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,+WACA;gBAED,GAAG,KAAK;;oBAER;kCACD,sYAAC,sXAAA,CAAA,QAAqB;wBAAC,WAAU;;0CAC/B,sYAAC,uRAAA,CAAA,QAAK;;;;;0CACN,sYAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKpC;MAxBS;AA0BT,SAAS,aAAa,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IACpB,qBACE,sYAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,aAAa,KAAoD;QAApD,EAAE,SAAS,EAAE,GAAG,OAAoC,GAApD;IACpB,qBACE,sYAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,KAGgC;QAHhC,EACnB,SAAS,EACT,GAAG,OACgD,GAHhC;IAInB,qBACE,sYAAC,sXAAA,CAAA,QAAqB;QACpB,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,kBAAkB,KAGgC;QAHhC,EACzB,SAAS,EACT,GAAG,OACsD,GAHhC;IAIzB,qBACE,sYAAC,sXAAA,CAAA,cAA2B;QAC1B,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MAXS","debugId":null}},
    {"offset": {"line": 624, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/tabs.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\n\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"~/lib/utils\"\n\nfunction Tabs({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\n  return (\n    <TabsPrimitive.Root\n      data-slot=\"tabs\"\n      className={cn(\"flex flex-col gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TabsList({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\n  return (\n    <TabsPrimitive.List\n      data-slot=\"tabs-list\"\n      className={cn(\n        \"bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsTrigger({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\n  return (\n    <TabsPrimitive.Trigger\n      data-slot=\"tabs-trigger\"\n      className={cn(\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\n  return (\n    <TabsPrimitive.Content\n      data-slot=\"tabs-content\"\n      className={cn(\"flex-1 outline-none\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;;;;AAK/B;AAEA;AALA;;;;AAOA,SAAS,KAAK,KAGoC;QAHpC,EACZ,SAAS,EACT,GAAG,OAC6C,GAHpC;IAIZ,qBACE,sYAAC,uXAAA,CAAA,OAAkB;QACjB,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,SAAS,KAGgC;QAHhC,EAChB,SAAS,EACT,GAAG,OAC6C,GAHhC;IAIhB,qBACE,sYAAC,uXAAA,CAAA,OAAkB;QACjB,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,uGACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,KAGgC;QAHhC,EACnB,SAAS,EACT,GAAG,OACgD,GAHhC;IAInB,qBACE,sYAAC,uXAAA,CAAA,UAAqB;QACpB,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,mqBACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,KAGgC;QAHhC,EACnB,SAAS,EACT,GAAG,OACgD,GAHhC;IAInB,qBACE,sYAAC,uXAAA,CAAA,UAAqB;QACpB,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;MAXS","debugId":null}},
    {"offset": {"line": 706, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/env.js"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { createEnv } from \"@t3-oss/env-nextjs\";\nimport { z } from \"zod\";\n\nexport const env = createEnv({\n  /**\n   * Specify your server-side environment variables schema here. This way you can ensure the app\n   * isn't built with invalid env vars.\n   */\n  server: {\n    NODE_ENV: z.enum([\"development\", \"test\", \"production\"]),\n    AMPLITUDE_API_KEY: z.string().optional(),\n    GITHUB_OAUTH_TOKEN: z.string().optional(),\n  },\n\n  /**\n   * Specify your client-side environment variables schema here. This way you can ensure the app\n   * isn't built with invalid env vars. To expose them to the client, prefix them with\n   * `NEXT_PUBLIC_`.\n   */\n  client: {\n    NEXT_PUBLIC_API_URL: z.string().optional(),\n    NEXT_PUBLIC_STATIC_WEBSITE_ONLY: z.boolean().optional(),\n    NEXT_PUBLIC_MAX_STREAM_BUFFER_SIZE: z.coerce.number().int().positive().optional(),\n  },\n\n  /**\n   * You can't destruct `process.env` as a regular object in the Next.js edge runtimes (e.g.\n   * middlewares) or client-side so we need to destruct manually.\n   */\n  runtimeEnv: {\n    NODE_ENV: process.env.NODE_ENV,\n    NEXT_PUBLIC_API_URL: process.env.NEXT_PUBLIC_API_URL,\n    NEXT_PUBLIC_STATIC_WEBSITE_ONLY:\n      process.env.NEXT_PUBLIC_STATIC_WEBSITE_ONLY === \"true\",\n    NEXT_PUBLIC_MAX_STREAM_BUFFER_SIZE: process.env.NEXT_PUBLIC_MAX_STREAM_BUFFER_SIZE,\n    AMPLITUDE_API_KEY: process.env.AMPLITUDE_API_KEY,\n    GITHUB_OAUTH_TOKEN: process.env.GITHUB_OAUTH_TOKEN,\n  },\n  /**\n   * Run `build` or `dev` with `SKIP_ENV_VALIDATION` to skip env validation. This is especially\n   * useful for Docker builds.\n   */\n  skipValidation: !!process.env.SKIP_ENV_VALIDATION,\n  /**\n   * Makes it so that empty strings are treated as undefined. `SOME_VAR: z.string()` and\n   * `SOME_VAR=''` will throw an error.\n   */\n  emptyStringAsUndefined: true,\n});\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAgCjB;AA9Bd;AACA;;;AAEO,MAAM,MAAM,CAAA,GAAA,wRAAA,CAAA,YAAS,AAAD,EAAE;IAC3B;;;GAGC,GACD,QAAQ;QACN,UAAU,wLAAA,CAAA,IAAC,CAAC,IAAI,CAAC;YAAC;YAAe;YAAQ;SAAa;QACtD,mBAAmB,wLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ;QACtC,oBAAoB,wLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ;IACzC;IAEA;;;;GAIC,GACD,QAAQ;QACN,qBAAqB,wLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ;QACxC,iCAAiC,wLAAA,CAAA,IAAC,CAAC,OAAO,GAAG,QAAQ;QACrD,oCAAoC,wLAAA,CAAA,IAAC,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,GAAG,QAAQ,GAAG,QAAQ;IACjF;IAEA;;;GAGC,GACD,YAAY;QACV,QAAQ;QACR,mBAAmB;QACnB,iCACE,yWAAA,CAAA,UAAO,CAAC,GAAG,CAAC,+BAA+B,KAAK;QAClD,oCAAoC,yWAAA,CAAA,UAAO,CAAC,GAAG,CAAC,kCAAkC;QAClF,mBAAmB,yWAAA,CAAA,UAAO,CAAC,GAAG,CAAC,iBAAiB;QAChD,oBAAoB,yWAAA,CAAA,UAAO,CAAC,GAAG,CAAC,kBAAkB;IACpD;IACA;;;GAGC,GACD,gBAAgB,CAAC,CAAC,yWAAA,CAAA,UAAO,CAAC,GAAG,CAAC,mBAAmB;IACjD;;;GAGC,GACD,wBAAwB;AAC1B","debugId":null}},
    {"offset": {"line": 767, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/replay/get-replay-id.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport function extractReplayIdFromSearchParams(params: string) {\n  const urlParams = new URLSearchParams(params);\n  if (urlParams.has(\"replay\")) {\n    return urlParams.get(\"replay\");\n  }\n  return null;\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAExB,SAAS,gCAAgC,MAAc;IAC5D,MAAM,YAAY,IAAI,gBAAgB;IACtC,IAAI,UAAU,GAAG,CAAC,WAAW;QAC3B,OAAO,UAAU,GAAG,CAAC;IACvB;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 788, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/replay/hooks.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { useSearchParams } from \"next/navigation\";\nimport { useMemo } from \"react\";\n\nimport { env } from \"~/env\";\n\nimport { extractReplayIdFromSearchParams } from \"./get-replay-id\";\n\nexport function useReplay() {\n  const searchParams = useSearchParams();\n  const replayId = useMemo(\n    () => extractReplayIdFromSearchParams(searchParams.toString()),\n    [searchParams],\n  );\n  return {\n    isReplay: replayId != null || env.NEXT_PUBLIC_STATIC_WEBSITE_ONLY,\n    replayId,\n  };\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAE/B;AACA;AAEA;AAEA;;;;;;AAEO,SAAS;;IACd,MAAM,eAAe,CAAA,GAAA,8UAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,WAAW,CAAA,GAAA,sWAAA,CAAA,UAAO,AAAD;uCACrB,IAAM,CAAA,GAAA,+IAAA,CAAA,kCAA+B,AAAD,EAAE,aAAa,QAAQ;sCAC3D;QAAC;KAAa;IAEhB,OAAO;QACL,UAAU,YAAY,QAAQ,6GAAA,CAAA,MAAG,CAAC,+BAA+B;QACjE;IACF;AACF;GAVgB;;QACO,8UAAA,CAAA,kBAAe","debugId":null}},
    {"offset": {"line": 829, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/replay/index.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport * from \"./hooks\";\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;AAE/B","debugId":null}},
    {"offset": {"line": 850, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/sse/fetch-stream.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { env } from \"~/env\";\n\nimport { type StreamEvent } from \"./StreamEvent\";\n\nexport async function* fetchStream(\n  url: string,\n  init: RequestInit,\n): AsyncIterable<StreamEvent> {\n  const response = await fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Cache-Control\": \"no-cache\",\n    },\n    ...init,\n  });\n  if (response.status !== 200) {\n    throw new Error(`Failed to fetch from ${url}: ${response.status}`);\n  }\n  // Read from response body, event by event. An event always ends with a '\\n\\n'.\n  const reader = response.body\n    ?.pipeThrough(new TextDecoderStream())\n    .getReader();\n  if (!reader) {\n    throw new Error(\"Response body is not readable\");\n  }\n\n  try {\n    let buffer = \"\";\n    // Use configurable buffer size from environment, default to 1MB (1048576 bytes)\n    const MAX_BUFFER_SIZE = env.NEXT_PUBLIC_MAX_STREAM_BUFFER_SIZE ?? (1024 * 1024);\n\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) {\n        // Handle remaining buffer data\n        if (buffer.trim()) {\n          const event = parseEvent(buffer.trim());\n          if (event) {\n            yield event;\n          }\n        }\n        break;\n      }\n\n      buffer += value;\n\n      // Check buffer size to avoid memory overflow\n      if (buffer.length > MAX_BUFFER_SIZE) {\n        throw new Error(\n          `Buffer overflow - received ${(buffer.length / 1024 / 1024).toFixed(2)}MB of data without proper event boundaries. ` +\n          `Max buffer size is ${(MAX_BUFFER_SIZE / 1024 / 1024).toFixed(2)}MB. ` +\n          `You can increase this by setting NEXT_PUBLIC_MAX_STREAM_BUFFER_SIZE environment variable.`\n        );\n      }\n\n      let newlineIndex;\n      while ((newlineIndex = buffer.indexOf(\"\\n\\n\")) !== -1) {\n        const chunk = buffer.slice(0, newlineIndex);\n        buffer = buffer.slice(newlineIndex + 2);\n\n        if (chunk.trim()) {\n          const event = parseEvent(chunk);\n          if (event) {\n            yield event;\n          }\n        }\n      }\n    }\n  } finally {\n    reader.releaseLock(); // Release the reader lock\n  }\n\n}\n\nfunction parseEvent(chunk: string) {\n  let resultEvent = \"message\";\n  let resultData: string | null = null;\n  for (const line of chunk.split(\"\\n\")) {\n    const pos = line.indexOf(\": \");\n    if (pos === -1) {\n      continue;\n    }\n    const key = line.slice(0, pos);\n    const value = line.slice(pos + 2);\n    if (key === \"event\") {\n      resultEvent = value;\n    } else if (key === \"data\") {\n      resultData = value;\n    }\n  }\n  if (resultEvent === \"message\" && resultData === null) {\n    return undefined;\n  }\n  return {\n    event: resultEvent,\n    data: resultData,\n  } as StreamEvent;\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAE/B;;AAIO,gBAAgB,YACrB,GAAW,EACX,IAAiB;QAcF;IAZf,MAAM,WAAW,MAAM,MAAM,KAAK;QAChC,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,iBAAiB;QACnB;QACA,GAAG,IAAI;IACT;IACA,IAAI,SAAS,MAAM,KAAK,KAAK;QAC3B,MAAM,IAAI,MAAM,AAAC,wBAA+B,OAAR,KAAI,MAAoB,OAAhB,SAAS,MAAM;IACjE;IACA,+EAA+E;IAC/E,MAAM,UAAS,iBAAA,SAAS,IAAI,cAAb,qCAAA,eACX,WAAW,CAAC,IAAI,qBACjB,SAAS;IACZ,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,IAAI,SAAS;YAEW;QADxB,gFAAgF;QAChF,MAAM,kBAAkB,CAAA,0CAAA,6GAAA,CAAA,MAAG,CAAC,kCAAkC,cAAtC,qDAAA,0CAA2C,OAAO;QAE1E,MAAO,KAAM;YACX,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,OAAO,IAAI;YACzC,IAAI,MAAM;gBACR,+BAA+B;gBAC/B,IAAI,OAAO,IAAI,IAAI;oBACjB,MAAM,QAAQ,WAAW,OAAO,IAAI;oBACpC,IAAI,OAAO;wBACT,MAAM;oBACR;gBACF;gBACA;YACF;YAEA,UAAU;YAEV,6CAA6C;YAC7C,IAAI,OAAO,MAAM,GAAG,iBAAiB;gBACnC,MAAM,IAAI,MACR,AAAC,8BAAsE,OAAzC,CAAC,OAAO,MAAM,GAAG,OAAO,IAAI,EAAE,OAAO,CAAC,IAAG,kDACvE,AAAC,sBAAgE,OAA3C,CAAC,kBAAkB,OAAO,IAAI,EAAE,OAAO,CAAC,IAAG,UAChE;YAEL;YAEA,IAAI;YACJ,MAAO,CAAC,eAAe,OAAO,OAAO,CAAC,OAAO,MAAM,CAAC,EAAG;gBACrD,MAAM,QAAQ,OAAO,KAAK,CAAC,GAAG;gBAC9B,SAAS,OAAO,KAAK,CAAC,eAAe;gBAErC,IAAI,MAAM,IAAI,IAAI;oBAChB,MAAM,QAAQ,WAAW;oBACzB,IAAI,OAAO;wBACT,MAAM;oBACR;gBACF;YACF;QACF;IACF,SAAU;QACR,OAAO,WAAW,IAAI,0BAA0B;IAClD;AAEF;AAEA,SAAS,WAAW,KAAa;IAC/B,IAAI,cAAc;IAClB,IAAI,aAA4B;IAChC,KAAK,MAAM,QAAQ,MAAM,KAAK,CAAC,MAAO;QACpC,MAAM,MAAM,KAAK,OAAO,CAAC;QACzB,IAAI,QAAQ,CAAC,GAAG;YACd;QACF;QACA,MAAM,MAAM,KAAK,KAAK,CAAC,GAAG;QAC1B,MAAM,QAAQ,KAAK,KAAK,CAAC,MAAM;QAC/B,IAAI,QAAQ,SAAS;YACnB,cAAc;QAChB,OAAO,IAAI,QAAQ,QAAQ;YACzB,aAAa;QACf;IACF;IACA,IAAI,gBAAgB,aAAa,eAAe,MAAM;QACpD,OAAO;IACT;IACA,OAAO;QACL,OAAO;QACP,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 946, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/sse/StreamEvent.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport interface StreamEvent {\n  event: string;\n  data: string;\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B","debugId":null}},
    {"offset": {"line": 959, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/sse/index.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport * from \"./fetch-stream\";\nexport * from \"./StreamEvent\";\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;AAE/B;AACA","debugId":null}},
    {"offset": {"line": 983, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/utils/time.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport function sleep(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAExB,SAAS,MAAM,EAAU;IAC9B,OAAO,IAAI,QAAQ,CAAC,UAAY,WAAW,SAAS;AACtD","debugId":null}},
    {"offset": {"line": 1000, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/utils/json.ts"],"sourcesContent":["import { parse } from \"best-effort-json-parser\";\n\n/**\n * Extract valid JSON from content that may have extra tokens.\n * Finds the last closing brace/bracket that could be valid JSON.\n */\nfunction extractValidJSON(content: string): string {\n  let braceCount = 0;\n  let bracketCount = 0;\n  let inString = false;\n  let escapeNext = false;\n  let lastValidEnd = -1;\n\n  for (let i = 0; i < content.length; i++) {\n    const char = content[i];\n    \n    if (escapeNext) {\n      escapeNext = false;\n      continue;\n    }\n    \n    if (char === \"\\\\\") {\n      escapeNext = true;\n      continue;\n    }\n    \n    if (char === '\"') {\n      inString = !inString;\n      continue;\n    }\n    \n    if (inString) {\n      continue;\n    }\n    \n    if (char === \"{\") {\n      braceCount++;\n    } else if (char === \"}\") {\n      if (braceCount > 0) {\n        braceCount--;\n        if (braceCount === 0) {\n          lastValidEnd = i;\n        }\n      }\n    } else if (char === \"[\") {\n      bracketCount++;\n    } else if (char === \"]\") {\n      if (bracketCount > 0) {\n        bracketCount--;\n        if (bracketCount === 0) {\n          lastValidEnd = i;\n        }\n      }\n    }\n  }\n  \n  if (lastValidEnd > 0) {\n    return content.substring(0, lastValidEnd + 1);\n  }\n  \n  return content;\n}\n\nexport function parseJSON<T>(json: string | null | undefined, fallback: T) {\n  if (!json) {\n    return fallback;\n  }\n  try {\n    let raw = json\n      .trim()\n      .replace(/^```json\\s*/, \"\")\n      .replace(/^```js\\s*/, \"\")\n      .replace(/^```ts\\s*/, \"\")\n      .replace(/^```plaintext\\s*/, \"\")\n      .replace(/^```\\s*/, \"\")\n      .replace(/\\s*```$/, \"\");\n    \n    // First attempt: try to extract valid JSON to remove extra tokens\n    if (raw.startsWith(\"{\") || raw.startsWith(\"[\")) {\n      raw = extractValidJSON(raw);\n    }\n    \n    // Parse the cleaned content\n    return parse(raw) as T;\n  } catch {\n    // Fallback: try to extract meaningful content from malformed JSON\n    // This is a last-resort attempt to salvage partial data\n    return fallback;\n  }\n}\n"],"names":[],"mappings":";;;AAAA;;AAEA;;;CAGC,GACD,SAAS,iBAAiB,OAAe;IACvC,IAAI,aAAa;IACjB,IAAI,eAAe;IACnB,IAAI,WAAW;IACf,IAAI,aAAa;IACjB,IAAI,eAAe,CAAC;IAEpB,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,MAAM,EAAE,IAAK;QACvC,MAAM,OAAO,OAAO,CAAC,EAAE;QAEvB,IAAI,YAAY;YACd,aAAa;YACb;QACF;QAEA,IAAI,SAAS,MAAM;YACjB,aAAa;YACb;QACF;QAEA,IAAI,SAAS,KAAK;YAChB,WAAW,CAAC;YACZ;QACF;QAEA,IAAI,UAAU;YACZ;QACF;QAEA,IAAI,SAAS,KAAK;YAChB;QACF,OAAO,IAAI,SAAS,KAAK;YACvB,IAAI,aAAa,GAAG;gBAClB;gBACA,IAAI,eAAe,GAAG;oBACpB,eAAe;gBACjB;YACF;QACF,OAAO,IAAI,SAAS,KAAK;YACvB;QACF,OAAO,IAAI,SAAS,KAAK;YACvB,IAAI,eAAe,GAAG;gBACpB;gBACA,IAAI,iBAAiB,GAAG;oBACtB,eAAe;gBACjB;YACF;QACF;IACF;IAEA,IAAI,eAAe,GAAG;QACpB,OAAO,QAAQ,SAAS,CAAC,GAAG,eAAe;IAC7C;IAEA,OAAO;AACT;AAEO,SAAS,UAAa,IAA+B,EAAE,QAAW;IACvE,IAAI,CAAC,MAAM;QACT,OAAO;IACT;IACA,IAAI;QACF,IAAI,MAAM,KACP,IAAI,GACJ,OAAO,CAAC,eAAe,IACvB,OAAO,CAAC,aAAa,IACrB,OAAO,CAAC,aAAa,IACrB,OAAO,CAAC,oBAAoB,IAC5B,OAAO,CAAC,WAAW,IACnB,OAAO,CAAC,WAAW;QAEtB,kEAAkE;QAClE,IAAI,IAAI,UAAU,CAAC,QAAQ,IAAI,UAAU,CAAC,MAAM;YAC9C,MAAM,iBAAiB;QACzB;QAEA,4BAA4B;QAC5B,OAAO,CAAA,GAAA,iPAAA,CAAA,QAAK,AAAD,EAAE;IACf,EAAE,UAAM;QACN,kEAAkE;QAClE,wDAAwD;QACxD,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 1083, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/utils/deep-clone.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport function deepClone<T>(value: T): T {\n  return JSON.parse(JSON.stringify(value));\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAExB,SAAS,UAAa,KAAQ;IACnC,OAAO,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC;AACnC","debugId":null}},
    {"offset": {"line": 1100, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/utils/index.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport * from \"./time\";\nexport * from \"./json\";\nexport * from \"./deep-clone\";\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;AAE/B;AACA;AACA","debugId":null}},
    {"offset": {"line": 1127, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/api/resolve-service-url.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { env } from \"~/env\";\n\nexport function resolveServiceURL(path: string) {\n  let BASE_URL = env.NEXT_PUBLIC_API_URL ?? \"http://localhost:8001/api/\";\n  if (!BASE_URL.endsWith(\"/\")) {\n    BASE_URL += \"/\";\n  }\n  return new URL(path, BASE_URL).toString();\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAE/B;;AAEO,SAAS,kBAAkB,IAAY;QAC7B;IAAf,IAAI,WAAW,CAAA,2BAAA,6GAAA,CAAA,MAAG,CAAC,mBAAmB,cAAvB,sCAAA,2BAA2B;IAC1C,IAAI,CAAC,SAAS,QAAQ,CAAC,MAAM;QAC3B,YAAY;IACd;IACA,OAAO,IAAI,IAAI,MAAM,UAAU,QAAQ;AACzC","debugId":null}},
    {"offset": {"line": 1151, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/api/chat.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { env } from \"~/env\";\n\nimport type { MCPServerMetadata } from \"../mcp\";\nimport type { Resource } from \"../messages\";\nimport { extractReplayIdFromSearchParams } from \"../replay/get-replay-id\";\nimport { fetchStream } from \"../sse\";\nimport { sleep } from \"../utils\";\n\nimport { resolveServiceURL } from \"./resolve-service-url\";\nimport type { ChatEvent } from \"./types\";\n\nfunction getLocaleFromCookie(): string {\n  if (typeof document === \"undefined\") return \"en-US\";\n  \n  // Map frontend locale codes to backend locale format\n  // Frontend uses: \"en\", \"zh\"\n  // Backend expects: \"en-US\", \"zh-CN\"\n  const LOCALE_MAP = { \"en\": \"en-US\", \"zh\": \"zh-CN\" } as const;\n  \n  // Initialize to raw locale format (matches cookie format)\n  let rawLocale = \"en\";\n  \n  // Read from cookie\n  const cookies = document.cookie.split(\";\");\n  for (const cookie of cookies) {\n    const [name, value] = cookie.trim().split(\"=\");\n    if (name === \"NEXT_LOCALE\" && value) {\n      rawLocale = decodeURIComponent(value);\n      break;\n    }\n  }\n  \n  // Map raw locale to backend format, fallback to en-US if unmapped\n  return LOCALE_MAP[rawLocale as keyof typeof LOCALE_MAP] ?? \"en-US\";\n}\n\nexport async function* chatStream(\n  userMessage: string,\n  params: {\n    thread_id: string;\n    resources?: Array<Resource>;\n    auto_accepted_plan: boolean;\n    enable_clarification?: boolean;\n    max_clarification_rounds?: number;\n    max_plan_iterations: number;\n    max_step_num: number;\n    max_search_results?: number;\n    interrupt_feedback?: string;\n    enable_deep_thinking?: boolean;\n    enable_background_investigation: boolean;\n    report_style?: \"academic\" | \"popular_science\" | \"news\" | \"social_media\" | \"strategic_investment\";\n    mcp_settings?: {\n      servers: Record<\n        string,\n        MCPServerMetadata & {\n          enabled_tools: string[];\n          add_to_agents: string[];\n        }\n      >;\n    };\n  },\n  options: { abortSignal?: AbortSignal } = {},\n) {\n  if (\n    env.NEXT_PUBLIC_STATIC_WEBSITE_ONLY ||\n    location.search.includes(\"mock\") ||\n    location.search.includes(\"replay=\")\n  ) \n    return yield* chatReplayStream(userMessage, params, options);\n  \n  try{\n    const locale = getLocaleFromCookie();\n    const stream = fetchStream(resolveServiceURL(\"chat/stream\"), {\n      body: JSON.stringify({\n        messages: [{ role: \"user\", content: userMessage }],\n        locale,\n        ...params,\n      }),\n      signal: options.abortSignal,\n    });\n    \n    for await (const event of stream) {\n      yield {\n        type: event.event,\n        data: JSON.parse(event.data),\n      } as ChatEvent;\n    }\n  }catch(e){\n    console.error(e);\n  }\n}\n\nasync function* chatReplayStream(\n  userMessage: string,\n  params: {\n    thread_id: string;\n    auto_accepted_plan: boolean;\n    max_plan_iterations: number;\n    max_step_num: number;\n    max_search_results?: number;\n    interrupt_feedback?: string;\n  } = {\n    thread_id: \"__mock__\",\n    auto_accepted_plan: false,\n    max_plan_iterations: 3,\n    max_step_num: 1,\n    max_search_results: 3,\n    interrupt_feedback: undefined,\n  },\n  options: { abortSignal?: AbortSignal } = {},\n): AsyncIterable<ChatEvent> {\n  const urlParams = new URLSearchParams(window.location.search);\n  let replayFilePath = \"\";\n  if (urlParams.has(\"mock\")) {\n    if (urlParams.get(\"mock\")) {\n      replayFilePath = `/mock/${urlParams.get(\"mock\")!}.txt`;\n    } else {\n      if (params.interrupt_feedback === \"accepted\") {\n        replayFilePath = \"/mock/final-answer.txt\";\n      } else if (params.interrupt_feedback === \"edit_plan\") {\n        replayFilePath = \"/mock/re-plan.txt\";\n      } else {\n        replayFilePath = \"/mock/first-plan.txt\";\n      }\n    }\n    fastForwardReplaying = true;\n  } else {\n    const replayId = extractReplayIdFromSearchParams(window.location.search);\n    if (replayId) {\n      replayFilePath = `/replay/${replayId}.txt`;\n    } else {\n      // Fallback to a default replay\n      replayFilePath = `/replay/eiffel-tower-vs-tallest-building.txt`;\n    }\n  }\n  const text = await fetchReplay(replayFilePath, {\n    abortSignal: options.abortSignal,\n  });\n  const normalizedText = text.replace(/\\r\\n/g, \"\\n\");\n  const chunks = normalizedText.split(\"\\n\\n\");\n  for (const chunk of chunks) {\n    const [eventRaw, dataRaw] = chunk.split(\"\\n\") as [string, string];\n    const [, event] = eventRaw.split(\"event: \", 2) as [string, string];\n    const [, data] = dataRaw.split(\"data: \", 2) as [string, string];\n\n    try {\n      const chatEvent = {\n        type: event,\n        data: JSON.parse(data),\n      } as ChatEvent;\n      if (chatEvent.type === \"message_chunk\") {\n        if (!chatEvent.data.finish_reason) {\n          await sleepInReplay(50);\n        }\n      } else if (chatEvent.type === \"tool_call_result\") {\n        await sleepInReplay(500);\n      }\n      yield chatEvent;\n      if (chatEvent.type === \"tool_call_result\") {\n        await sleepInReplay(800);\n      } else if (chatEvent.type === \"message_chunk\") {\n        if (chatEvent.data.role === \"user\") {\n          await sleepInReplay(500);\n        }\n      }\n    } catch (e) {\n      console.error(e);\n    }\n  }\n}\n\nconst replayCache = new Map<string, string>();\nexport async function fetchReplay(\n  url: string,\n  options: { abortSignal?: AbortSignal } = {},\n) {\n  if (replayCache.has(url)) {\n    return replayCache.get(url)!;\n  }\n  const res = await fetch(url, {\n    signal: options.abortSignal,\n  });\n  if (!res.ok) {\n    throw new Error(`Failed to fetch replay: ${res.statusText}`);\n  }\n  const text = await res.text();\n  replayCache.set(url, text);\n  return text;\n}\n\nexport async function fetchReplayTitle() {\n  const res = chatReplayStream(\n    \"\",\n    {\n      thread_id: \"__mock__\",\n      auto_accepted_plan: false,\n      max_plan_iterations: 3,\n      max_step_num: 1,\n      max_search_results: 3,\n    },\n    {},\n  );\n  for await (const event of res) {\n    if (event.type === \"message_chunk\") {\n      return event.data.content;\n    }\n  }\n}\n\nexport async function sleepInReplay(ms: number) {\n  if (fastForwardReplaying) {\n    await sleep(0);\n  } else {\n    await sleep(ms);\n  }\n}\n\nlet fastForwardReplaying = false;\nexport function fastForwardReplay(value: boolean) {\n  fastForwardReplaying = value;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1341, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/api/mcp.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport type { SimpleMCPServerMetadata } from \"../mcp\";\n\nimport { resolveServiceURL } from \"./resolve-service-url\";\n\nexport async function queryMCPServerMetadata(config: SimpleMCPServerMetadata, signal?: AbortSignal) {\n  const response = await fetch(resolveServiceURL(\"mcp/server/metadata\"), {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(config),\n    signal,\n  });\n  if (!response.ok) {\n    throw new Error(`HTTP error! status: ${response.status}`);\n  }\n  return response.json();\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAI/B;;AAEO,eAAe,uBAAuB,MAA+B,EAAE,MAAoB;IAChG,MAAM,WAAW,MAAM,MAAM,CAAA,GAAA,kJAAA,CAAA,oBAAiB,AAAD,EAAE,wBAAwB;QACrE,QAAQ;QACR,SAAS;YACP,gBAAgB;QAClB;QACA,MAAM,KAAK,SAAS,CAAC;QACrB;IACF;IACA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,AAAC,uBAAsC,OAAhB,SAAS,MAAM;IACxD;IACA,OAAO,SAAS,IAAI;AACtB","debugId":null}},
    {"offset": {"line": 1371, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/api/podcast.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { resolveServiceURL } from \"./resolve-service-url\";\n\nexport async function generatePodcast(content: string) {\n  const response = await fetch(resolveServiceURL(\"podcast/generate\"), {\n    method: \"post\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ content }),\n  });\n  if (!response.ok) {\n    throw new Error(`HTTP error! status: ${response.status}`);\n  }\n  const arrayBuffer = await response.arrayBuffer();\n  const blob = new Blob([arrayBuffer], { type: \"audio/mp3\" });\n  const audioUrl = URL.createObjectURL(blob);\n  return audioUrl;\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAE/B;;AAEO,eAAe,gBAAgB,OAAe;IACnD,MAAM,WAAW,MAAM,MAAM,CAAA,GAAA,kJAAA,CAAA,oBAAiB,AAAD,EAAE,qBAAqB;QAClE,QAAQ;QACR,SAAS;YACP,gBAAgB;QAClB;QACA,MAAM,KAAK,SAAS,CAAC;YAAE;QAAQ;IACjC;IACA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,AAAC,uBAAsC,OAAhB,SAAS,MAAM;IACxD;IACA,MAAM,cAAc,MAAM,SAAS,WAAW;IAC9C,MAAM,OAAO,IAAI,KAAK;QAAC;KAAY,EAAE;QAAE,MAAM;IAAY;IACzD,MAAM,WAAW,IAAI,eAAe,CAAC;IACrC,OAAO;AACT","debugId":null}},
    {"offset": {"line": 1409, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/api/prompt-enhancer.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { resolveServiceURL } from \"./resolve-service-url\";\n\nexport interface EnhancePromptRequest {\n  prompt: string;\n  context?: string;\n  report_style?: string;\n}\n\nexport interface EnhancePromptResponse {\n  enhanced_prompt: string;\n}\n\nexport async function enhancePrompt(\n  request: EnhancePromptRequest,\n): Promise<string> {\n  const response = await fetch(resolveServiceURL(\"prompt/enhance\"), {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(request),\n  });\n\n  if (!response.ok) {\n    throw new Error(`HTTP error! status: ${response.status}`);\n  }\n\n  const data = await response.json();\n  console.log(\"Raw API response:\", data); // Debug log\n\n  // The backend now returns the enhanced prompt directly in the result field\n  let enhancedPrompt = data.result;\n\n  // If the result is somehow still a JSON object, extract the enhanced_prompt\n  if (typeof enhancedPrompt === \"object\" && enhancedPrompt.enhanced_prompt) {\n    enhancedPrompt = enhancedPrompt.enhanced_prompt;\n  }\n\n  // If the result is a JSON string, try to parse it\n  if (typeof enhancedPrompt === \"string\") {\n    try {\n      const parsed = JSON.parse(enhancedPrompt);\n      if (parsed.enhanced_prompt) {\n        enhancedPrompt = parsed.enhanced_prompt;\n      }\n    } catch {\n      // If parsing fails, use the string as-is (which is what we want)\n      console.log(\"Using enhanced prompt as-is:\", enhancedPrompt);\n    }\n  }\n\n  // Fallback to original prompt if something went wrong\n  if (!enhancedPrompt || enhancedPrompt.trim() === \"\") {\n    console.warn(\"No enhanced prompt received, using original\");\n    enhancedPrompt = request.prompt;\n  }\n\n  return enhancedPrompt;\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAE/B;;AAYO,eAAe,cACpB,OAA6B;IAE7B,MAAM,WAAW,MAAM,MAAM,CAAA,GAAA,kJAAA,CAAA,oBAAiB,AAAD,EAAE,mBAAmB;QAChE,QAAQ;QACR,SAAS;YACP,gBAAgB;QAClB;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,AAAC,uBAAsC,OAAhB,SAAS,MAAM;IACxD;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,QAAQ,GAAG,CAAC,qBAAqB,OAAO,YAAY;IAEpD,2EAA2E;IAC3E,IAAI,iBAAiB,KAAK,MAAM;IAEhC,4EAA4E;IAC5E,IAAI,OAAO,mBAAmB,YAAY,eAAe,eAAe,EAAE;QACxE,iBAAiB,eAAe,eAAe;IACjD;IAEA,kDAAkD;IAClD,IAAI,OAAO,mBAAmB,UAAU;QACtC,IAAI;YACF,MAAM,SAAS,KAAK,KAAK,CAAC;YAC1B,IAAI,OAAO,eAAe,EAAE;gBAC1B,iBAAiB,OAAO,eAAe;YACzC;QACF,EAAE,UAAM;YACN,iEAAiE;YACjE,QAAQ,GAAG,CAAC,gCAAgC;QAC9C;IACF;IAEA,sDAAsD;IACtD,IAAI,CAAC,kBAAkB,eAAe,IAAI,OAAO,IAAI;QACnD,QAAQ,IAAI,CAAC;QACb,iBAAiB,QAAQ,MAAM;IACjC;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 1463, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/api/types.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport type { Option } from \"../messages\";\n\n// Tool Calls\n\nexport interface ToolCall {\n  type: \"tool_call\";\n  id: string;\n  name: string;\n  args: Record<string, unknown>;\n}\n\nexport interface ToolCallChunk {\n  type: \"tool_call_chunk\";\n  index: number;\n  id: string;\n  name: string;\n  args: string;\n}\n\n// Events\n\ninterface GenericEvent<T extends string, D extends object> {\n  type: T;\n  data: {\n    id: string;\n    thread_id: string;\n    agent: \"coordinator\" | \"planner\" | \"researcher\" | \"coder\" | \"reporter\";\n    role: \"user\" | \"assistant\" | \"tool\";\n    finish_reason?: \"stop\" | \"tool_calls\" | \"interrupt\";\n  } & D;\n}\n\nexport interface MessageChunkEvent\n  extends GenericEvent<\n    \"message_chunk\",\n    {\n      content?: string;\n      reasoning_content?: string;\n    }\n  > {}\n\nexport interface ToolCallsEvent\n  extends GenericEvent<\n    \"tool_calls\",\n    {\n      tool_calls: ToolCall[];\n      tool_call_chunks: ToolCallChunk[];\n    }\n  > {}\n\nexport interface ToolCallChunksEvent\n  extends GenericEvent<\n    \"tool_call_chunks\",\n    {\n      tool_call_chunks: ToolCallChunk[];\n    }\n  > {}\n\nexport interface ToolCallResultEvent\n  extends GenericEvent<\n    \"tool_call_result\",\n    {\n      tool_call_id: string;\n      content?: string;\n    }\n  > {}\n\nexport interface InterruptEvent\n  extends GenericEvent<\n    \"interrupt\",\n    {\n      options: Option[];\n    }\n  > {}\n\nexport type ChatEvent =\n  | MessageChunkEvent\n  | ToolCallsEvent\n  | ToolCallChunksEvent\n  | ToolCallResultEvent\n  | InterruptEvent;\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B","debugId":null}},
    {"offset": {"line": 1476, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/api/index.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport * from \"./chat\";\nexport * from \"./mcp\";\nexport * from \"./podcast\";\nexport * from \"./prompt-enhancer\";\nexport * from \"./types\";\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;AAE/B;AACA;AACA;AACA;AACA","debugId":null}},
    {"offset": {"line": 1509, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/messages/types.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport type MessageRole = \"user\" | \"assistant\" | \"tool\";\n\nexport interface Message {\n  id: string;\n  threadId: string;\n  agent?:\n    | \"coordinator\"\n    | \"planner\"\n    | \"researcher\"\n    | \"coder\"\n    | \"reporter\"\n    | \"podcast\";\n  role: MessageRole;\n  isStreaming?: boolean;\n  content: string;\n  contentChunks: string[];\n  reasoningContent?: string;\n  reasoningContentChunks?: string[];\n  toolCalls?: ToolCallRuntime[];\n  options?: Option[];\n  finishReason?: \"stop\" | \"interrupt\" | \"tool_calls\";\n  interruptFeedback?: string;\n  resources?: Array<Resource>;\n}\n\nexport interface Option {\n  text: string;\n  value: string;\n}\n\nexport interface ToolCallRuntime {\n  id: string;\n  name: string;\n  args: Record<string, unknown>;\n  argsChunks?: string[];\n  result?: string;\n}\n\nexport interface Resource {\n  uri: string;\n  title: string;\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B","debugId":null}},
    {"offset": {"line": 1522, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/messages/merge-message.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport type {\n  ChatEvent,\n  InterruptEvent,\n  MessageChunkEvent,\n  ToolCallChunksEvent,\n  ToolCallResultEvent,\n  ToolCallsEvent,\n} from \"../api\";\nimport { deepClone } from \"../utils/deep-clone\";\n\nimport type { Message } from \"./types\";\n\nexport function mergeMessage(message: Message, event: ChatEvent) {\n  if (event.type === \"message_chunk\") {\n    mergeTextMessage(message, event);\n  } else if (event.type === \"tool_calls\" || event.type === \"tool_call_chunks\") {\n    mergeToolCallMessage(message, event);\n  } else if (event.type === \"tool_call_result\") {\n    mergeToolCallResultMessage(message, event);\n  } else if (event.type === \"interrupt\") {\n    mergeInterruptMessage(message, event);\n  }\n  if (event.data.finish_reason) {\n    message.finishReason = event.data.finish_reason;\n    message.isStreaming = false;\n    if (message.toolCalls) {\n      message.toolCalls.forEach((toolCall) => {\n        if (toolCall.argsChunks?.length) {\n          toolCall.args = JSON.parse(toolCall.argsChunks.join(\"\"));\n          delete toolCall.argsChunks;\n        }\n      });\n    }\n  }\n  return deepClone(message);\n}\n\nfunction mergeTextMessage(message: Message, event: MessageChunkEvent) {\n  if (event.data.content) {\n    message.content += event.data.content;\n    message.contentChunks.push(event.data.content);\n  }\n  if (event.data.reasoning_content) {\n    message.reasoningContent = (message.reasoningContent ?? \"\") + event.data.reasoning_content;\n    message.reasoningContentChunks = message.reasoningContentChunks ?? [];\n    message.reasoningContentChunks.push(event.data.reasoning_content);\n  }\n}\nfunction convertToolChunkArgs(args: string) {\n  // Convert escaped characters in args\n  if (!args) return \"\";\n  return args.replace(/&#91;/g, \"[\").replace(/&#93;/g, \"]\").replace(/&#123;/g, \"{\").replace(/&#125;/g, \"}\");\n}\nfunction mergeToolCallMessage(\n  message: Message,\n  event: ToolCallsEvent | ToolCallChunksEvent,\n) {\n  if (event.type === \"tool_calls\" && event.data.tool_calls[0]?.name) {\n    message.toolCalls = event.data.tool_calls.map((raw) => ({\n      id: raw.id,\n      name: raw.name,\n      args: raw.args,\n      result: undefined,\n    }));\n  }\n\n  message.toolCalls ??= [];\n  for (const chunk of event.data.tool_call_chunks) {\n    if (chunk.id) {\n      const toolCall = message.toolCalls.find(\n        (toolCall) => toolCall.id === chunk.id,\n      );\n      if (toolCall) {\n        toolCall.argsChunks = [convertToolChunkArgs(chunk.args)];\n      }\n    } else {\n      const streamingToolCall = message.toolCalls.find(\n        (toolCall) => toolCall.argsChunks?.length,\n      );\n      if (streamingToolCall) {\n        streamingToolCall.argsChunks!.push(convertToolChunkArgs(chunk.args));\n      }\n    }\n  }\n}\n\nfunction mergeToolCallResultMessage(\n  message: Message,\n  event: ToolCallResultEvent,\n) {\n  const toolCall = message.toolCalls?.find(\n    (toolCall) => toolCall.id === event.data.tool_call_id,\n  );\n  if (toolCall) {\n    toolCall.result = event.data.content;\n  }\n}\n\nfunction mergeInterruptMessage(message: Message, event: InterruptEvent) {\n  message.isStreaming = false;\n  message.options = event.data.options;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1624, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/messages/index.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport * from \"./types\";\nexport * from \"./merge-message\";\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;AAE/B;AACA","debugId":null}},
    {"offset": {"line": 1648, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/store/settings-store.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { create } from \"zustand\";\n\nimport type { MCPServerMetadata, SimpleMCPServerMetadata } from \"../mcp\";\n\nconst SETTINGS_KEY = \"deerflow.settings\";\n\nconst DEFAULT_SETTINGS: SettingsState = {\n  general: {\n    autoAcceptedPlan: false,\n    enableClarification: false,\n    maxClarificationRounds: 3,\n    enableDeepThinking: false,\n    enableBackgroundInvestigation: false,\n    maxPlanIterations: 1,\n    maxStepNum: 3,\n    maxSearchResults: 3,\n    reportStyle: \"academic\",\n  },\n  mcp: {\n    servers: [],\n  },\n};\n\nexport type SettingsState = {\n  general: {\n    autoAcceptedPlan: boolean;\n    enableClarification: boolean;\n    maxClarificationRounds: number;\n    enableDeepThinking: boolean;\n    enableBackgroundInvestigation: boolean;\n    maxPlanIterations: number;\n    maxStepNum: number;\n    maxSearchResults: number;\n    reportStyle: \"academic\" | \"popular_science\" | \"news\" | \"social_media\" | \"strategic_investment\";\n  };\n  mcp: {\n    servers: MCPServerMetadata[];\n  };\n};\n\nexport const useSettingsStore = create<SettingsState>(() => ({\n  ...DEFAULT_SETTINGS,\n}));\n\nexport const useSettings = (key: keyof SettingsState) => {\n  return useSettingsStore((state) => state[key]);\n};\n\nexport const changeSettings = (settings: SettingsState) => {\n  useSettingsStore.setState(settings);\n};\n\nexport const loadSettings = () => {\n  if (typeof window === \"undefined\") {\n    return;\n  }\n  const json = localStorage.getItem(SETTINGS_KEY);\n  if (json) {\n    const settings = JSON.parse(json);\n    for (const key in DEFAULT_SETTINGS.general) {\n      if (!(key in settings.general)) {\n        settings.general[key as keyof SettingsState[\"general\"]] =\n          DEFAULT_SETTINGS.general[key as keyof SettingsState[\"general\"]];\n      }\n    }\n\n    try {\n      useSettingsStore.setState(settings);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n};\n\nexport const saveSettings = () => {\n  const latestSettings = useSettingsStore.getState();\n  const json = JSON.stringify(latestSettings);\n  localStorage.setItem(SETTINGS_KEY, json);\n};\n\nexport const getChatStreamSettings = () => {\n  let mcpSettings:\n    | {\n        servers: Record<\n          string,\n          MCPServerMetadata & {\n            enabled_tools: string[];\n            add_to_agents: string[];\n          }\n        >;\n      }\n    | undefined = undefined;\n  const { mcp, general } = useSettingsStore.getState();\n  const mcpServers = mcp.servers.filter((server) => server.enabled);\n  if (mcpServers.length > 0) {\n    mcpSettings = {\n      servers: mcpServers.reduce((acc, cur) => {\n        const { transport, env, headers } = cur;\n        let server: SimpleMCPServerMetadata;\n        if (transport === \"stdio\") {\n          server = {\n            name: cur.name,\n            transport,\n            env,\n            command: cur.command,\n            args: cur.args,\n          };\n        } else {\n          server = {\n            name: cur.name,\n            transport,\n            headers,\n            url: cur.url,\n          };\n        }\n        return {\n          ...acc,\n          [cur.name]: {\n            ...server,\n            enabled_tools: cur.tools.map((tool) => tool.name),\n            add_to_agents: [\"researcher\"],\n          },\n        };\n      }, {}),\n    };\n  }\n  return {\n    ...general,\n    mcpSettings,\n  };\n};\n\nexport function setReportStyle(\n  value: \"academic\" | \"popular_science\" | \"news\" | \"social_media\" | \"strategic_investment\",\n) {\n  useSettingsStore.setState((state) => ({\n    general: {\n      ...state.general,\n      reportStyle: value,\n    },\n  }));\n  saveSettings();\n}\n\nexport function setEnableDeepThinking(value: boolean) {\n  useSettingsStore.setState((state) => ({\n    general: {\n      ...state.general,\n      enableDeepThinking: value,\n    },\n  }));\n  saveSettings();\n}\n\nexport function setEnableBackgroundInvestigation(value: boolean) {\n  useSettingsStore.setState((state) => ({\n    general: {\n      ...state.general,\n      enableBackgroundInvestigation: value,\n    },\n  }));\n  saveSettings();\n}\n\nexport function setEnableClarification(value: boolean) {\n  useSettingsStore.setState((state) => ({\n    general: {\n      ...state.general,\n      enableClarification: value,\n    },\n  }));\n  saveSettings();\n}\nloadSettings();\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1811, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/store/store.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { nanoid } from \"nanoid\";\nimport { toast } from \"sonner\";\nimport { create } from \"zustand\";\nimport { useShallow } from \"zustand/react/shallow\";\n\nimport { chatStream, generatePodcast } from \"../api\";\nimport type { Message, Resource } from \"../messages\";\nimport { mergeMessage } from \"../messages\";\nimport { parseJSON } from \"../utils\";\n\nimport { getChatStreamSettings } from \"./settings-store\";\n\nconst THREAD_ID = nanoid();\n\nexport const useStore = create<{\n  responding: boolean;\n  threadId: string | undefined;\n  messageIds: string[];\n  messages: Map<string, Message>;\n  researchIds: string[];\n  researchPlanIds: Map<string, string>;\n  researchReportIds: Map<string, string>;\n  researchActivityIds: Map<string, string[]>;\n  ongoingResearchId: string | null;\n  openResearchId: string | null;\n\n  appendMessage: (message: Message) => void;\n  updateMessage: (message: Message) => void;\n  updateMessages: (messages: Message[]) => void;\n  openResearch: (researchId: string | null) => void;\n  closeResearch: () => void;\n  setOngoingResearch: (researchId: string | null) => void;\n}>((set) => ({\n  responding: false,\n  threadId: THREAD_ID,\n  messageIds: [],\n  messages: new Map<string, Message>(),\n  researchIds: [],\n  researchPlanIds: new Map<string, string>(),\n  researchReportIds: new Map<string, string>(),\n  researchActivityIds: new Map<string, string[]>(),\n  ongoingResearchId: null,\n  openResearchId: null,\n\n  appendMessage(message: Message) {\n    set((state) => {\n      // Prevent duplicate message IDs in the array to avoid React key warnings\n      const newMessageIds = state.messageIds.includes(message.id)\n        ? state.messageIds\n        : [...state.messageIds, message.id];\n      return {\n        messageIds: newMessageIds,\n        messages: new Map(state.messages).set(message.id, message),\n      };\n    });\n  },\n  updateMessage(message: Message) {\n    set((state) => ({\n      messages: new Map(state.messages).set(message.id, message),\n    }));\n  },\n  updateMessages(messages: Message[]) {\n    set((state) => {\n      const newMessages = new Map(state.messages);\n      messages.forEach((m) => newMessages.set(m.id, m));\n      return { messages: newMessages };\n    });\n  },\n  openResearch(researchId: string | null) {\n    set({ openResearchId: researchId });\n  },\n  closeResearch() {\n    set({ openResearchId: null });\n  },\n  setOngoingResearch(researchId: string | null) {\n    set({ ongoingResearchId: researchId });\n  },\n}));\n\nexport async function sendMessage(\n  content?: string,\n  {\n    interruptFeedback,\n    resources,\n  }: {\n    interruptFeedback?: string;\n    resources?: Array<Resource>;\n  } = {},\n  options: { abortSignal?: AbortSignal } = {},\n) {\n  if (content != null) {\n    appendMessage({\n      id: nanoid(),\n      threadId: THREAD_ID,\n      role: \"user\",\n      content: content,\n      contentChunks: [content],\n      resources,\n    });\n  }\n\n  const settings = getChatStreamSettings();\n  const stream = chatStream(\n    content ?? \"[REPLAY]\",\n    {\n      thread_id: THREAD_ID,\n      interrupt_feedback: interruptFeedback,\n      resources,\n      auto_accepted_plan: settings.autoAcceptedPlan,\n      enable_clarification: settings.enableClarification ?? false,\n      max_clarification_rounds: settings.maxClarificationRounds ?? 3,\n      enable_deep_thinking: settings.enableDeepThinking ?? false,\n      enable_background_investigation:\n        settings.enableBackgroundInvestigation ?? true,\n      max_plan_iterations: settings.maxPlanIterations,\n      max_step_num: settings.maxStepNum,\n      max_search_results: settings.maxSearchResults,\n      report_style: settings.reportStyle,\n      mcp_settings: settings.mcpSettings,\n    },\n    options,\n  );\n\n  setResponding(true);\n  let messageId: string | undefined;\n  const pendingUpdates = new Map<string, Message>();\n  let updateTimer: NodeJS.Timeout | undefined;\n\n  const scheduleUpdate = () => {\n    if (updateTimer) clearTimeout(updateTimer);\n    updateTimer = setTimeout(() => {\n      // Batch update message status\n      if (pendingUpdates.size > 0) {\n        useStore.getState().updateMessages(Array.from(pendingUpdates.values()));\n        pendingUpdates.clear();\n      }\n    }, 16); // ~60fps\n  };\n\n  try {\n    for await (const event of stream) {\n      const { type, data } = event;\n      let message: Message | undefined;\n      \n      // Handle tool_call_result specially: use the message that contains the tool call\n      if (type === \"tool_call_result\") {\n        message = findMessageByToolCallId(data.tool_call_id);\n        if (message) {\n          // Use the found message's ID, not data.id\n          messageId = message.id;\n        } else {\n          // Shouldn't happen, but handle gracefully\n          if (process.env.NODE_ENV === \"development\") {\n            console.warn(`Tool call result without matching message: ${data.tool_call_id}`);\n          }\n          continue; // Skip this event\n        }\n      } else {\n        // For other event types, use data.id\n        messageId = data.id;\n        \n        if (!existsMessage(messageId)) {\n          message = {\n            id: messageId,\n            threadId: data.thread_id,\n            agent: data.agent,\n            role: data.role,\n            content: \"\",\n            contentChunks: [],\n            reasoningContent: \"\",\n            reasoningContentChunks: [],\n            isStreaming: true,\n            interruptFeedback,\n          };\n          appendMessage(message);\n        }\n      }\n      \n      message ??= getMessage(messageId);\n      if (message) {\n        message = mergeMessage(message, event);\n        // Collect pending messages for update, instead of updating immediately.\n        pendingUpdates.set(message.id, message);\n        scheduleUpdate();\n      }\n    }\n  } catch {\n    toast(\"An error occurred while generating the response. Please try again.\");\n    // Update message status.\n    // TODO: const isAborted = (error as Error).name === \"AbortError\";\n    if (messageId != null) {\n      const message = getMessage(messageId);\n      if (message?.isStreaming) {\n        message.isStreaming = false;\n        useStore.getState().updateMessage(message);\n      }\n    }\n    useStore.getState().setOngoingResearch(null);\n  } finally {\n    setResponding(false);\n    // Ensure all pending updates are processed.\n    if (updateTimer) clearTimeout(updateTimer);\n    if (pendingUpdates.size > 0) {\n      useStore.getState().updateMessages(Array.from(pendingUpdates.values()));\n    }\n\n  }\n}\n\nfunction setResponding(value: boolean) {\n  useStore.setState({ responding: value });\n}\n\nfunction existsMessage(id: string) {\n  return useStore.getState().messageIds.includes(id);\n}\n\nfunction getMessage(id: string) {\n  return useStore.getState().messages.get(id);\n}\n\nfunction findMessageByToolCallId(toolCallId: string) {\n  return Array.from(useStore.getState().messages.values())\n    .reverse()\n    .find((message) => {\n      if (message.toolCalls) {\n        return message.toolCalls.some((toolCall) => toolCall.id === toolCallId);\n      }\n      return false;\n    });\n}\n\nfunction appendMessage(message: Message) {\n  if (\n    message.agent === \"coder\" ||\n    message.agent === \"reporter\" ||\n    message.agent === \"researcher\"\n  ) {\n    if (!getOngoingResearchId()) {\n      const id = message.id;\n      appendResearch(id);\n      openResearch(id);\n    }\n    appendResearchActivity(message);\n  }\n  useStore.getState().appendMessage(message);\n}\n\nfunction updateMessage(message: Message) {\n  if (\n    getOngoingResearchId() &&\n    message.agent === \"reporter\" &&\n    !message.isStreaming\n  ) {\n    useStore.getState().setOngoingResearch(null);\n  }\n  useStore.getState().updateMessage(message);\n}\n\nfunction getOngoingResearchId() {\n  return useStore.getState().ongoingResearchId;\n}\n\nfunction appendResearch(researchId: string) {\n  let planMessage: Message | undefined;\n  const reversedMessageIds = [...useStore.getState().messageIds].reverse();\n  for (const messageId of reversedMessageIds) {\n    const message = getMessage(messageId);\n    if (message?.agent === \"planner\") {\n      planMessage = message;\n      break;\n    }\n  }\n  const messageIds = [researchId];\n  messageIds.unshift(planMessage!.id);\n  useStore.setState({\n    ongoingResearchId: researchId,\n    researchIds: [...useStore.getState().researchIds, researchId],\n    researchPlanIds: new Map(useStore.getState().researchPlanIds).set(\n      researchId,\n      planMessage!.id,\n    ),\n    researchActivityIds: new Map(useStore.getState().researchActivityIds).set(\n      researchId,\n      messageIds,\n    ),\n  });\n}\n\nfunction appendResearchActivity(message: Message) {\n  const researchId = getOngoingResearchId();\n  if (researchId) {\n    const researchActivityIds = useStore.getState().researchActivityIds;\n    const current = researchActivityIds.get(researchId)!;\n    if (!current.includes(message.id)) {\n      useStore.setState({\n        researchActivityIds: new Map(researchActivityIds).set(researchId, [\n          ...current,\n          message.id,\n        ]),\n      });\n    }\n    if (message.agent === \"reporter\") {\n      useStore.setState({\n        researchReportIds: new Map(useStore.getState().researchReportIds).set(\n          researchId,\n          message.id,\n        ),\n      });\n    }\n  }\n}\n\nexport function openResearch(researchId: string | null) {\n  useStore.getState().openResearch(researchId);\n}\n\nexport function closeResearch() {\n  useStore.getState().closeResearch();\n}\n\nexport async function listenToPodcast(researchId: string) {\n  const planMessageId = useStore.getState().researchPlanIds.get(researchId);\n  const reportMessageId = useStore.getState().researchReportIds.get(researchId);\n  if (planMessageId && reportMessageId) {\n    const planMessage = getMessage(planMessageId)!;\n    const title = parseJSON(planMessage.content, { title: \"Untitled\" }).title;\n    const reportMessage = getMessage(reportMessageId);\n    if (reportMessage?.content) {\n      appendMessage({\n        id: nanoid(),\n        threadId: THREAD_ID,\n        role: \"user\",\n        content: \"Please generate a podcast for the above research.\",\n        contentChunks: [],\n      });\n      const podCastMessageId = nanoid();\n      const podcastObject = { title, researchId };\n      const podcastMessage: Message = {\n        id: podCastMessageId,\n        threadId: THREAD_ID,\n        role: \"assistant\",\n        agent: \"podcast\",\n        content: JSON.stringify(podcastObject),\n        contentChunks: [],\n        reasoningContent: \"\",\n        reasoningContentChunks: [],\n        isStreaming: true,\n      };\n      appendMessage(podcastMessage);\n      // Generating podcast...\n      let audioUrl: string | undefined;\n      try {\n        audioUrl = await generatePodcast(reportMessage.content);\n      } catch (e) {\n        console.error(e);\n        useStore.setState((state) => ({\n          messages: new Map(useStore.getState().messages).set(\n            podCastMessageId,\n            {\n              ...state.messages.get(podCastMessageId)!,\n              content: JSON.stringify({\n                ...podcastObject,\n                error: e instanceof Error ? e.message : \"Unknown error\",\n              }),\n              isStreaming: false,\n            },\n          ),\n        }));\n        toast(\"An error occurred while generating podcast. Please try again.\");\n        return;\n      }\n      useStore.setState((state) => ({\n        messages: new Map(useStore.getState().messages).set(podCastMessageId, {\n          ...state.messages.get(podCastMessageId)!,\n          content: JSON.stringify({ ...podcastObject, audioUrl }),\n          isStreaming: false,\n        }),\n      }));\n    }\n  }\n}\n\nexport function useResearchMessage(researchId: string) {\n  return useStore(\n    useShallow((state) => {\n      const messageId = state.researchPlanIds.get(researchId);\n      return messageId ? state.messages.get(messageId) : undefined;\n    }),\n  );\n}\n\nexport function useMessage(messageId: string | null | undefined) {\n  return useStore(\n    useShallow((state) =>\n      messageId ? state.messages.get(messageId) : undefined,\n    ),\n  );\n}\n\nexport function useMessageIds() {\n  return useStore(useShallow((state) => state.messageIds));\n}\n\nexport function useRenderableMessageIds() {\n  return useStore(\n    useShallow((state) => {\n      // Filter to only messages that will actually render in MessageListView\n      // This prevents duplicate keys and React warnings when messages change state\n      return state.messageIds.filter((messageId) => {\n        const message = state.messages.get(messageId);\n        if (!message) return false;\n        \n        // Only include messages that match MessageListItem rendering conditions\n        // These are the same conditions checked in MessageListItem component\n        return (\n          message.role === \"user\" ||\n          message.agent === \"coordinator\" ||\n          message.agent === \"planner\" ||\n          message.agent === \"podcast\" ||\n          state.researchIds.includes(messageId) // startOfResearch condition\n        );\n      });\n    }),\n  );\n}\n\nexport function useLastInterruptMessage() {\n  return useStore(\n    useShallow((state) => {\n      if (state.messageIds.length >= 2) {\n        const lastMessage = state.messages.get(\n          state.messageIds[state.messageIds.length - 1]!,\n        );\n        return lastMessage?.finishReason === \"interrupt\" ? lastMessage : null;\n      }\n      return null;\n    }),\n  );\n}\n\nexport function useLastFeedbackMessageId() {\n  const waitingForFeedbackMessageId = useStore(\n    useShallow((state) => {\n      if (state.messageIds.length >= 2) {\n        const lastMessage = state.messages.get(\n          state.messageIds[state.messageIds.length - 1]!,\n        );\n        if (lastMessage && lastMessage.finishReason === \"interrupt\") {\n          return state.messageIds[state.messageIds.length - 2];\n        }\n      }\n      return null;\n    }),\n  );\n  return waitingForFeedbackMessageId;\n}\n\nexport function useToolCalls() {\n  return useStore(\n    useShallow((state) => {\n      return state.messageIds\n        ?.map((id) => getMessage(id)?.toolCalls)\n        .filter((toolCalls) => toolCalls != null)\n        .flat();\n    }),\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2298, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/store/index.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport * from \"./store\";\nexport * from \"./settings-store\";\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;AAE/B;AACA","debugId":null}},
    {"offset": {"line": 2322, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/rehype/rehype-split-words-into-spans.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport type { Element, Root, ElementContent } from \"hast\";\nimport { visit } from \"unist-util-visit\";\nimport type { BuildVisitor } from \"unist-util-visit\";\n\nexport function rehypeSplitWordsIntoSpans() {\n  return (tree: Root) => {\n    visit(tree, \"element\", ((node: Element) => {\n      if (\n        [\"p\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", \"li\", \"strong\"].includes(\n          node.tagName,\n        ) &&\n        node.children\n      ) {\n        const newChildren: Array<ElementContent> = [];\n        node.children.forEach((child) => {\n          if (child.type === \"text\") {\n            const segmenter = new Intl.Segmenter(\"zh\", { granularity: \"word\" });\n            const segments = segmenter.segment(child.value);\n            const words = Array.from(segments)\n              .map((segment) => segment.segment)\n              .filter(Boolean);\n            words.forEach((word: string) => {\n              newChildren.push({\n                type: \"element\",\n                tagName: \"span\",\n                properties: {\n                  className: \"animate-fade-in\",\n                },\n                children: [{ type: \"text\", value: word }],\n              });\n            });\n          } else {\n            newChildren.push(child);\n          }\n        });\n        node.children = newChildren;\n      }\n    }) as BuildVisitor<Root, \"element\">);\n  };\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAG/B;;AAGO,SAAS;IACd,OAAO,CAAC;QACN,CAAA,GAAA,4OAAA,CAAA,QAAK,AAAD,EAAE,MAAM,WAAY,CAAC;YACvB,IACE;gBAAC;gBAAK;gBAAM;gBAAM;gBAAM;gBAAM;gBAAM;gBAAM;gBAAM;aAAS,CAAC,QAAQ,CAChE,KAAK,OAAO,KAEd,KAAK,QAAQ,EACb;gBACA,MAAM,cAAqC,EAAE;gBAC7C,KAAK,QAAQ,CAAC,OAAO,CAAC,CAAC;oBACrB,IAAI,MAAM,IAAI,KAAK,QAAQ;wBACzB,MAAM,YAAY,IAAI,KAAK,SAAS,CAAC,MAAM;4BAAE,aAAa;wBAAO;wBACjE,MAAM,WAAW,UAAU,OAAO,CAAC,MAAM,KAAK;wBAC9C,MAAM,QAAQ,MAAM,IAAI,CAAC,UACtB,GAAG,CAAC,CAAC,UAAY,QAAQ,OAAO,EAChC,MAAM,CAAC;wBACV,MAAM,OAAO,CAAC,CAAC;4BACb,YAAY,IAAI,CAAC;gCACf,MAAM;gCACN,SAAS;gCACT,YAAY;oCACV,WAAW;gCACb;gCACA,UAAU;oCAAC;wCAAE,MAAM;wCAAQ,OAAO;oCAAK;iCAAE;4BAC3C;wBACF;oBACF,OAAO;wBACL,YAAY,IAAI,CAAC;oBACnB;gBACF;gBACA,KAAK,QAAQ,GAAG;YAClB;QACF;IACF;AACF","debugId":null}},
    {"offset": {"line": 2384, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/rehype/index.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport * from \"./rehype-split-words-into-spans\";\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;AAE/B","debugId":null}},
    {"offset": {"line": 2405, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/markdown/katex.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport type { Options as RehypeKatexOptions } from \"rehype-katex\";\n\nimport \"katex/contrib/mhchem\";\n\nconst macros = {\n  \"\\\\vect\": \"\\\\mathbf{#1}\",\n  \"\\\\mat\": \"\\\\mathbf{#1}\",\n  \"\\\\grad\": \"\\\\nabla #1\",\n  \"\\\\div\": \"\\\\nabla \\\\cdot #1\",\n  \"\\\\curl\": \"\\\\nabla \\\\times #1\",\n  \"\\\\dv\": \"\\\\frac{d #1}{d #2}\",\n  \"\\\\pdv\": \"\\\\frac{\\\\partial #1}{\\\\partial #2}\",\n  \"\\\\pdvN\": \"\\\\frac{\\\\partial^{#3} #1}{\\\\partial #2^{#3}}\",\n  \"\\\\abs\": \"\\\\left|#1\\\\right|\",\n  \"\\\\norm\": \"\\\\left\\\\lVert#1\\\\right\\\\rVert\",\n  \"\\\\set\": \"\\\\left\\\\{#1\\\\right\\\\}\",\n  \"\\\\bra\": \"\\\\left\\\\langle#1\\\\right|\",\n  \"\\\\ket\": \"\\\\left|#1\\\\right\\\\rangle\",\n  \"\\\\braket\": \"\\\\left\\\\langle#1\\\\middle|#2\\\\right\\\\rangle\",\n  \"\\\\matrix\": \"\\\\begin{pmatrix}#1\\\\end{pmatrix}\",\n} as const;\n\nexport const katexOptions: RehypeKatexOptions = {\n  macros,\n  strict: \"ignore\",\n  trust: (context) => context.command === \"\\\\htmlClass\" || context.command === \"\\\\href\",\n};\n\nexport type KatexMacroKey = keyof typeof macros;\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAI/B;;AAEA,MAAM,SAAS;IACb,UAAU;IACV,SAAS;IACT,UAAU;IACV,SAAS;IACT,UAAU;IACV,QAAQ;IACR,SAAS;IACT,UAAU;IACV,SAAS;IACT,UAAU;IACV,SAAS;IACT,SAAS;IACT,SAAS;IACT,YAAY;IACZ,YAAY;AACd;AAEO,MAAM,eAAmC;IAC9C;IACA,QAAQ;IACR,OAAO,CAAC,UAAY,QAAQ,OAAO,KAAK,iBAAiB,QAAQ,OAAO,KAAK;AAC/E","debugId":null}},
    {"offset": {"line": 2443, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/utils/markdown.ts"],"sourcesContent":["export function autoFixMarkdown(markdown: string): string {\n  return autoCloseTrailingLink(markdown);\n}\n\n/**\n * Unescape markdown-escaped characters within math delimiters\n * tiptap-markdown escapes special characters like *, _, [, ] which corrupts math formulas\n * This function restores the original LaTeX by unescaping within $...$ and $$...$$\n */\nexport function unescapeLatexInMath(markdown: string): string {\n  let result = markdown;\n\n  // Process inline math: $...$\n  result = result.replace(/\\$([^\\$]+?)\\$/g, (match, mathContent) => {\n    const unescaped = unescapeMarkdownSpecialChars(mathContent);\n    return `$${unescaped}$`;\n  });\n\n  // Process display math: $$...$$\n  result = result.replace(/\\$\\$([\\s\\S]+?)\\$\\$/g, (match, mathContent) => {\n    const unescaped = unescapeMarkdownSpecialChars(mathContent);\n    return `$$${unescaped}$$`;\n  });\n\n  return result;\n}\n\n/**\n * Reverse markdown escaping for special characters\n * Order matters: process \\\\ last to avoid re-escaping\n */\nfunction unescapeMarkdownSpecialChars(text: string): string {\n  return text\n    .replace(/\\\\\\*/g, '*')      // \\* â†’ *\n    .replace(/\\\\_/g, '_')       // \\_ â†’ _\n    .replace(/\\\\\\[/g, '[')      // \\[ â†’ [\n    .replace(/\\\\\\]/g, ']')      // \\] â†’ ]\n    .replace(/\\\\\\{/g, '{')      // \\{ â†’ {\n    .replace(/\\\\\\}/g, '}')      // \\} â†’ }\n    .replace(/\\\\\\\\/g, '\\\\');    // \\\\ â†’ \\\n}\n\n/**\n * Normalize math delimiters for editor consumption\n * Converts display delimiters (\\[...\\], \\\\[...\\\\]) to $$ format\n * Converts inline delimiters (\\(...\\), \\\\(...\\\\)) to $ format\n * This ensures consistent format before loading into Tiptap editor\n */\nexport function normalizeMathForEditor(markdown: string): string {\n  let normalized = markdown;\n  \n  // Convert display math - handle double backslash first to avoid conflicts\n  normalized = normalized\n    .replace(/\\\\\\\\\\[([^\\]]*)\\\\\\\\\\]/g, (_match, content) => `$$${content}$$`)  // \\\\[...\\\\] â†’ $$...$$\n    .replace(/\\\\\\[([^\\]]*)\\\\\\]/g, (_match, content) => `$$${content}$$`);  // \\[...\\] â†’ $$...$$\n  \n  // Convert inline math - handle double backslash first to avoid conflicts\n  normalized = normalized\n    .replace(/\\\\\\\\\\(([^)]*)\\\\\\\\\\)/g, (_match, content) => `$${content}$`)  // \\\\(...\\\\) â†’ $...$\n    .replace(/\\\\\\(([^)]*)\\\\\\)/g, (_match, content) => `$${content}$`);    // \\(...\\) â†’ $...$\n  \n  // Replace double backslashes with single in math contexts\n  // For inline math: $...$\n  normalized = normalized.replace(\n    /\\$([^\\$]+?)\\$/g,\n    (match, mathContent) => {\n      return `$${mathContent.replace(/\\\\\\\\/g, '\\\\')}$`;\n    }\n  );\n  \n  // For display math: $$...$$\n  normalized = normalized.replace(\n    /\\$\\$([\\s\\S]+?)\\$\\$/g,\n    (match, mathContent) => {\n      return `$$${mathContent.replace(/\\\\\\\\/g, '\\\\')}$$`;\n    }\n  );\n\n  return normalized;\n}\n\n/**\n * Normalize math delimiters for display consumption\n * Ensures all math delimiters are in $$ format for remarkMath/rehypeKatex\n * This is used by the Markdown display component\n */\nexport function normalizeMathForDisplay(markdown: string): string {\n  let normalized = markdown;\n  \n  // Convert all LaTeX-style delimiters to $$\n  // Both display and inline math use $$ for display component (remarkMath handles both)\n  // Handle double backslash first to avoid conflicts\n  normalized = normalized\n    .replace(/\\\\\\\\\\[([^\\]]*)\\\\\\\\\\]/g, (_match, content) => `$$${content}$$`)  // \\\\[...\\\\] â†’ $$...$$\n    .replace(/\\\\\\[([^\\]]*)\\\\\\]/g, (_match, content) => `$$${content}$$`)      // \\[...\\] â†’ $$...$$\n    .replace(/\\\\\\\\\\(([^)]*)\\\\\\\\\\)/g, (_match, content) => `$$${content}$$`)   // \\\\(...\\\\) â†’ $$...$$\n    .replace(/\\\\\\(([^)]*)\\\\\\)/g, (_match, content) => `$$${content}$$`);       // \\(...\\) â†’ $$...$$\n  \n  // Replace double backslashes with single in math contexts\n  // For inline math: $...$\n  normalized = normalized.replace(\n    /\\$([^\\$]+?)\\$/g,\n    (match, mathContent) => {\n      return `$${mathContent.replace(/\\\\\\\\/g, '\\\\')}$`;\n    }\n  );\n  \n  // For display math: $$...$$\n  normalized = normalized.replace(\n    /\\$\\$([\\s\\S]+?)\\$\\$/g,\n    (match, mathContent) => {\n      return `$$${mathContent.replace(/\\\\\\\\/g, '\\\\')}$$`;\n    }\n  );\n    \n  return normalized;\n}\n\nfunction autoCloseTrailingLink(markdown: string): string {\n  // Fix unclosed Markdown links or images\n  let fixedMarkdown: string = markdown;\n\n  // Fix unclosed image syntax ![...](...)\n  fixedMarkdown = fixedMarkdown.replace(\n    /!\\[([^\\]]*)\\]\\(([^)]*)$/g,\n    (match: string, altText: string, url: string): string => {\n      return `![${altText}](${url})`;\n    },\n  );\n\n  // Fix unclosed link syntax [...](...)\n  fixedMarkdown = fixedMarkdown.replace(\n    /\\[([^\\]]*)\\]\\(([^)]*)$/g,\n    (match: string, linkText: string, url: string): string => {\n      return `[${linkText}](${url})`;\n    },\n  );\n\n  // Fix unclosed image syntax ![...]\n  fixedMarkdown = fixedMarkdown.replace(\n    /!\\[([^\\]]*)$/g,\n    (match: string, altText: string): string => {\n      return `![${altText}]`;\n    },\n  );\n\n  // Fix unclosed link syntax [...]\n  fixedMarkdown = fixedMarkdown.replace(\n    /\\[([^\\]]*)$/g,\n    (match: string, linkText: string): string => {\n      return `[${linkText}]`;\n    },\n  );\n\n  // Fix unclosed images or links missing \")\"\n  fixedMarkdown = fixedMarkdown.replace(\n    /!\\[([^\\]]*)\\]\\(([^)]*)$/g,\n    (match: string, altText: string, url: string): string => {\n      return `![${altText}](${url})`;\n    },\n  );\n\n  fixedMarkdown = fixedMarkdown.replace(\n    /\\[([^\\]]*)\\]\\(([^)]*)$/g,\n    (match: string, linkText: string, url: string): string => {\n      return `[${linkText}](${url})`;\n    },\n  );\n\n  return fixedMarkdown;\n}\n"],"names":[],"mappings":";;;;;;AAAO,SAAS,gBAAgB,QAAgB;IAC9C,OAAO,sBAAsB;AAC/B;AAOO,SAAS,oBAAoB,QAAgB;IAClD,IAAI,SAAS;IAEb,6BAA6B;IAC7B,SAAS,OAAO,OAAO,CAAC,kBAAkB,CAAC,OAAO;QAChD,MAAM,YAAY,6BAA6B;QAC/C,OAAO,AAAC,IAAa,OAAV,WAAU;IACvB;IAEA,gCAAgC;IAChC,SAAS,OAAO,OAAO,CAAC,uBAAuB,CAAC,OAAO;QACrD,MAAM,YAAY,6BAA6B;QAC/C,OAAO,AAAC,KAAc,OAAV,WAAU;IACxB;IAEA,OAAO;AACT;AAEA;;;CAGC,GACD,SAAS,6BAA6B,IAAY;IAChD,OAAO,KACJ,OAAO,CAAC,SAAS,KAAU,SAAS;KACpC,OAAO,CAAC,QAAQ,KAAW,SAAS;KACpC,OAAO,CAAC,SAAS,KAAU,SAAS;KACpC,OAAO,CAAC,SAAS,KAAU,SAAS;KACpC,OAAO,CAAC,SAAS,KAAU,SAAS;KACpC,OAAO,CAAC,SAAS,KAAU,SAAS;KACpC,OAAO,CAAC,SAAS,OAAU,SAAS;AACzC;AAQO,SAAS,uBAAuB,QAAgB;IACrD,IAAI,aAAa;IAEjB,0EAA0E;IAC1E,aAAa,WACV,OAAO,CAAC,yBAAyB,CAAC,QAAQ,UAAY,AAAC,KAAY,OAAR,SAAQ,OAAM,sBAAsB;KAC/F,OAAO,CAAC,qBAAqB,CAAC,QAAQ,UAAY,AAAC,KAAY,OAAR,SAAQ,QAAO,oBAAoB;IAE7F,yEAAyE;IACzE,aAAa,WACV,OAAO,CAAC,wBAAwB,CAAC,QAAQ,UAAY,AAAC,IAAW,OAAR,SAAQ,MAAK,oBAAoB;KAC1F,OAAO,CAAC,oBAAoB,CAAC,QAAQ,UAAY,AAAC,IAAW,OAAR,SAAQ,OAAQ,kBAAkB;IAE1F,0DAA0D;IAC1D,yBAAyB;IACzB,aAAa,WAAW,OAAO,CAC7B,kBACA,CAAC,OAAO;QACN,OAAO,AAAC,IAAsC,OAAnC,YAAY,OAAO,CAAC,SAAS,OAAM;IAChD;IAGF,4BAA4B;IAC5B,aAAa,WAAW,OAAO,CAC7B,uBACA,CAAC,OAAO;QACN,OAAO,AAAC,KAAuC,OAAnC,YAAY,OAAO,CAAC,SAAS,OAAM;IACjD;IAGF,OAAO;AACT;AAOO,SAAS,wBAAwB,QAAgB;IACtD,IAAI,aAAa;IAEjB,2CAA2C;IAC3C,sFAAsF;IACtF,mDAAmD;IACnD,aAAa,WACV,OAAO,CAAC,yBAAyB,CAAC,QAAQ,UAAY,AAAC,KAAY,OAAR,SAAQ,OAAM,sBAAsB;KAC/F,OAAO,CAAC,qBAAqB,CAAC,QAAQ,UAAY,AAAC,KAAY,OAAR,SAAQ,OAAU,oBAAoB;KAC7F,OAAO,CAAC,wBAAwB,CAAC,QAAQ,UAAY,AAAC,KAAY,OAAR,SAAQ,OAAO,sBAAsB;KAC/F,OAAO,CAAC,oBAAoB,CAAC,QAAQ,UAAY,AAAC,KAAY,OAAR,SAAQ,QAAY,oBAAoB;IAEjG,0DAA0D;IAC1D,yBAAyB;IACzB,aAAa,WAAW,OAAO,CAC7B,kBACA,CAAC,OAAO;QACN,OAAO,AAAC,IAAsC,OAAnC,YAAY,OAAO,CAAC,SAAS,OAAM;IAChD;IAGF,4BAA4B;IAC5B,aAAa,WAAW,OAAO,CAC7B,uBACA,CAAC,OAAO;QACN,OAAO,AAAC,KAAuC,OAAnC,YAAY,OAAO,CAAC,SAAS,OAAM;IACjD;IAGF,OAAO;AACT;AAEA,SAAS,sBAAsB,QAAgB;IAC7C,wCAAwC;IACxC,IAAI,gBAAwB;IAE5B,wCAAwC;IACxC,gBAAgB,cAAc,OAAO,CACnC,4BACA,CAAC,OAAe,SAAiB;QAC/B,OAAO,AAAC,KAAgB,OAAZ,SAAQ,MAAQ,OAAJ,KAAI;IAC9B;IAGF,sCAAsC;IACtC,gBAAgB,cAAc,OAAO,CACnC,2BACA,CAAC,OAAe,UAAkB;QAChC,OAAO,AAAC,IAAgB,OAAb,UAAS,MAAQ,OAAJ,KAAI;IAC9B;IAGF,mCAAmC;IACnC,gBAAgB,cAAc,OAAO,CACnC,iBACA,CAAC,OAAe;QACd,OAAO,AAAC,KAAY,OAAR,SAAQ;IACtB;IAGF,iCAAiC;IACjC,gBAAgB,cAAc,OAAO,CACnC,gBACA,CAAC,OAAe;QACd,OAAO,AAAC,IAAY,OAAT,UAAS;IACtB;IAGF,2CAA2C;IAC3C,gBAAgB,cAAc,OAAO,CACnC,4BACA,CAAC,OAAe,SAAiB;QAC/B,OAAO,AAAC,KAAgB,OAAZ,SAAQ,MAAQ,OAAJ,KAAI;IAC9B;IAGF,gBAAgB,cAAc,OAAO,CACnC,2BACA,CAAC,OAAe,UAAkB;QAChC,OAAO,AAAC,IAAgB,OAAb,UAAS,MAAQ,OAAJ,KAAI;IAC9B;IAGF,OAAO;AACT","debugId":null}},
    {"offset": {"line": 2554, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/deer-flow/image.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { memo, useCallback, useEffect, useState } from \"react\";\n\nimport { cn } from \"~/lib/utils\";\n\nimport { Tooltip } from \"./tooltip\";\n\nfunction Image({\n  className,\n  imageClassName,\n  imageTransition,\n  src,\n  alt,\n  fallback = null,\n}: {\n  className?: string;\n  imageClassName?: string;\n  imageTransition?: boolean;\n  src: string;\n  alt: string;\n  fallback?: React.ReactNode;\n}) {\n  const [, setIsLoading] = useState(true);\n  const [isError, setIsError] = useState(false);\n\n  useEffect(() => {\n    setIsError(false);\n    setIsLoading(true);\n  }, [src]);\n\n  const handleLoad = useCallback(() => {\n    setIsError(false);\n    setIsLoading(false);\n  }, []);\n  const handleError = useCallback(\n    (e: React.SyntheticEvent<HTMLImageElement>) => {\n      e.currentTarget.style.display = \"none\";\n      console.warn(`Markdown: Image \"${e.currentTarget.src}\" failed to load`);\n      setIsError(true);\n    },\n    [],\n  );\n  return (\n    <span className={cn(\"block w-fit overflow-hidden\", className)}>\n      {isError || !src ? (\n        fallback\n      ) : (\n        <Tooltip title={alt ?? \"No caption\"}>\n          <img\n            className={cn(\n              \"size-full object-cover\",\n              imageTransition && \"transition-all duration-200 ease-out\",\n              imageClassName,\n            )}\n            src={src}\n            alt={alt}\n            onLoad={handleLoad}\n            onError={handleError}\n          />\n        </Tooltip>\n      )}\n    </span>\n  );\n}\n\nexport default memo(Image);\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;AAE/B;AAEA;AAEA;;;;;;AAEA,SAAS,MAAM,KAcd;QAdc,EACb,SAAS,EACT,cAAc,EACd,eAAe,EACf,GAAG,EACH,GAAG,EACH,WAAW,IAAI,EAQhB,GAdc;;IAeb,MAAM,GAAG,aAAa,GAAG,CAAA,GAAA,sWAAA,CAAA,WAAQ,AAAD,EAAE;IAClC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,sWAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,sWAAA,CAAA,YAAS,AAAD;2BAAE;YACR,WAAW;YACX,aAAa;QACf;0BAAG;QAAC;KAAI;IAER,MAAM,aAAa,CAAA,GAAA,sWAAA,CAAA,cAAW,AAAD;yCAAE;YAC7B,WAAW;YACX,aAAa;QACf;wCAAG,EAAE;IACL,MAAM,cAAc,CAAA,GAAA,sWAAA,CAAA,cAAW,AAAD;0CAC5B,CAAC;YACC,EAAE,aAAa,CAAC,KAAK,CAAC,OAAO,GAAG;YAChC,QAAQ,IAAI,CAAC,AAAC,oBAAuC,OAApB,EAAE,aAAa,CAAC,GAAG,EAAC;YACrD,WAAW;QACb;yCACA,EAAE;IAEJ,qBACE,sYAAC;QAAK,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,+BAA+B;kBAChD,WAAW,CAAC,MACX,yBAEA,sYAAC,gJAAA,CAAA,UAAO;YAAC,OAAO,gBAAA,iBAAA,MAAO;sBACrB,cAAA,sYAAC;gBACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,0BACA,mBAAmB,wCACnB;gBAEF,KAAK;gBACL,KAAK;gBACL,QAAQ;gBACR,SAAS;;;;;;;;;;;;;;;;AAMrB;GAxDS;KAAA;2DA0DM,CAAA,GAAA,sWAAA,CAAA,OAAI,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 2635, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/deer-flow/link.tsx"],"sourcesContent":["import { useMemo } from \"react\";\nimport { useStore, useToolCalls } from \"~/core/store\";\nimport { parseJSON } from \"~/core/utils/json\";\nimport { Tooltip } from \"./tooltip\";\nimport { WarningFilled } from \"@ant-design/icons\";\nimport { useTranslations } from \"next-intl\";\n\nexport const Link = ({\n  href,\n  children,\n  checkLinkCredibility = false,\n}: {\n  href: string | undefined;\n  children: React.ReactNode;\n  checkLinkCredibility: boolean;\n}) => {\n  const toolCalls = useToolCalls();\n  const responding = useStore((state) => state.responding);\n\n  const credibleLinks = useMemo(() => {\n    const links = new Set<string>();\n    if (!checkLinkCredibility) return links;\n\n    (toolCalls || []).forEach((call) => {\n      if (call && call.name === \"web_search\" && call.result) {\n        try {\n          const result = parseJSON(call.result, []) as Array<{ url: string }>;\n          if (Array.isArray(result)) {\n            result.forEach((r) => {\n              if (r && typeof r.url === 'string') {\n                // encodeURI is used to handle the case where the link contains chinese or other special characters\n                links.add(encodeURI(r.url));\n                links.add(r.url);\n              }\n            });\n          }\n        } catch (error) {\n          console.warn('Failed to parse web_search result:', error);\n        }\n      }\n    });\n    return links;\n  }, [toolCalls]);\n\n  const isCredible = useMemo(() => {\n    return checkLinkCredibility && href && !responding\n      ? credibleLinks.has(href)\n      : true;\n  }, [credibleLinks, href, responding, checkLinkCredibility]);\n\n  const t = useTranslations(\"common\");\n  return (\n    <span className=\"inline-flex items-center gap-1.5\">\n      <a href={href} target=\"_blank\" rel=\"noopener noreferrer\">\n        {children}\n      </a>\n      {!isCredible && (\n        <Tooltip title={t(\"linkNotReliable\")} delayDuration={300}>\n          <WarningFilled className=\"text-sx transition-colors hover:!text-yellow-500\" />\n        </Tooltip>\n      )}\n    </span>\n  );\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;AAEO,MAAM,OAAO;QAAC,EACnB,IAAI,EACJ,QAAQ,EACR,uBAAuB,KAAK,EAK7B;;IACC,MAAM,YAAY,CAAA,GAAA,gIAAA,CAAA,eAAY,AAAD;IAC7B,MAAM,aAAa,CAAA,GAAA,gIAAA,CAAA,WAAQ,AAAD;qCAAE,CAAC,QAAU,MAAM,UAAU;;IAEvD,MAAM,gBAAgB,CAAA,GAAA,sWAAA,CAAA,UAAO,AAAD;uCAAE;YAC5B,MAAM,QAAQ,IAAI;YAClB,IAAI,CAAC,sBAAsB,OAAO;YAElC,CAAC,aAAa,EAAE,EAAE,OAAO;+CAAC,CAAC;oBACzB,IAAI,QAAQ,KAAK,IAAI,KAAK,gBAAgB,KAAK,MAAM,EAAE;wBACrD,IAAI;4BACF,MAAM,SAAS,CAAA,GAAA,+HAAA,CAAA,YAAS,AAAD,EAAE,KAAK,MAAM,EAAE,EAAE;4BACxC,IAAI,MAAM,OAAO,CAAC,SAAS;gCACzB,OAAO,OAAO;mEAAC,CAAC;wCACd,IAAI,KAAK,OAAO,EAAE,GAAG,KAAK,UAAU;4CAClC,mGAAmG;4CACnG,MAAM,GAAG,CAAC,UAAU,EAAE,GAAG;4CACzB,MAAM,GAAG,CAAC,EAAE,GAAG;wCACjB;oCACF;;4BACF;wBACF,EAAE,OAAO,OAAO;4BACd,QAAQ,IAAI,CAAC,sCAAsC;wBACrD;oBACF;gBACF;;YACA,OAAO;QACT;sCAAG;QAAC;KAAU;IAEd,MAAM,aAAa,CAAA,GAAA,sWAAA,CAAA,UAAO,AAAD;oCAAE;YACzB,OAAO,wBAAwB,QAAQ,CAAC,aACpC,cAAc,GAAG,CAAC,QAClB;QACN;mCAAG;QAAC;QAAe;QAAM;QAAY;KAAqB;IAE1D,MAAM,IAAI,CAAA,GAAA,8ZAAA,CAAA,kBAAe,AAAD,EAAE;IAC1B,qBACE,sYAAC;QAAK,WAAU;;0BACd,sYAAC;gBAAE,MAAM;gBAAM,QAAO;gBAAS,KAAI;0BAChC;;;;;;YAEF,CAAC,4BACA,sYAAC,gJAAA,CAAA,UAAO;gBAAC,OAAO,EAAE;gBAAoB,eAAe;0BACnD,cAAA,sYAAC,yWAAA,CAAA,gBAAa;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAKnC;GAxDa;;QASO,gIAAA,CAAA,eAAY;QACX,gIAAA,CAAA,WAAQ;QAiCjB,8ZAAA,CAAA,kBAAe;;;KA3Cd","debugId":null}},
    {"offset": {"line": 2757, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/deer-flow/markdown.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { Check, Copy } from \"lucide-react\";\nimport { useMemo, useState } from \"react\";\nimport ReactMarkdown, {\n  type Options as ReactMarkdownOptions,\n} from \"react-markdown\";\nimport rehypeKatex from \"rehype-katex\";\nimport remarkGfm from \"remark-gfm\";\nimport remarkMath from \"remark-math\";\nimport \"katex/dist/katex.min.css\";\n\nimport { Button } from \"~/components/ui/button\";\nimport { rehypeSplitWordsIntoSpans } from \"~/core/rehype\";\nimport { katexOptions } from \"~/core/markdown/katex\";\nimport { autoFixMarkdown, normalizeMathForDisplay } from \"~/core/utils/markdown\";\nimport { cn } from \"~/lib/utils\";\n\nimport Image from \"./image\";\nimport { Tooltip } from \"./tooltip\";\nimport { Link } from \"./link\";\n\nexport function Markdown({\n  className,\n  children,\n  style,\n  enableCopy,\n  animated = false,\n  checkLinkCredibility = false,\n  ...props\n}: ReactMarkdownOptions & {\n  className?: string;\n  enableCopy?: boolean;\n  style?: React.CSSProperties;\n  animated?: boolean;\n  checkLinkCredibility?: boolean;\n}) {\n  const components: ReactMarkdownOptions[\"components\"] = useMemo(() => {\n    return {\n      a: ({ href, children }) => (\n        <Link href={href} checkLinkCredibility={checkLinkCredibility}>\n          {children}\n        </Link>\n      ),\n      img: ({ src, alt }) => (\n        <a href={src as string} target=\"_blank\" rel=\"noopener noreferrer\">\n          <Image className=\"rounded\" src={src as string} alt={alt ?? \"\"} />\n        </a>\n      ),\n    };\n  }, [checkLinkCredibility]);\n\n  const rehypePlugins = useMemo<NonNullable<ReactMarkdownOptions[\"rehypePlugins\"]>>(() => {\n    const plugins: NonNullable<ReactMarkdownOptions[\"rehypePlugins\"]> = [[\n      rehypeKatex,\n      katexOptions,\n    ]];\n    if (animated) {\n      plugins.push(rehypeSplitWordsIntoSpans);\n    }\n    return plugins;\n  }, [animated]);\n  return (\n    <div className={cn(className, \"prose dark:prose-invert\")} style={style}>\n      <ReactMarkdown\n        remarkPlugins={[remarkGfm, remarkMath]}\n        rehypePlugins={rehypePlugins}\n        components={components}\n        {...props}\n      >\n        {autoFixMarkdown(\n          dropMarkdownQuote(normalizeMathForDisplay(children ?? \"\")) ?? \"\",\n        )}\n      </ReactMarkdown>\n      {enableCopy && typeof children === \"string\" && (\n        <div className=\"flex\">\n          <CopyButton content={children} />\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction CopyButton({ content }: { content: string }) {\n  const [copied, setCopied] = useState(false);\n  return (\n    <Tooltip title=\"Copy\">\n      <Button\n        variant=\"outline\"\n        size=\"sm\"\n        className=\"rounded-full\"\n        onClick={async () => {\n          try {\n            await navigator.clipboard.writeText(content);\n            setCopied(true);\n            setTimeout(() => {\n              setCopied(false);\n            }, 1000);\n          } catch (error) {\n            console.error(error);\n          }\n        }}\n      >\n        {copied ? (\n          <Check className=\"h-4 w-4\" />\n        ) : (\n          <Copy className=\"h-4 w-4\" />\n        )}{\" \"}\n      </Button>\n    </Tooltip>\n  );\n}\n\n\n\nfunction dropMarkdownQuote(markdown?: string | null): string | null {\n  if (!markdown) return null;\n\n  const patternsToRemove = [\n    { prefix: \"```markdown\\n\", suffix: \"\\n```\", prefixLen: 12 },\n    { prefix: \"```text\\n\", suffix: \"\\n```\", prefixLen: 8 },\n    { prefix: \"```\\n\", suffix: \"\\n```\", prefixLen: 4 },\n  ];\n\n  let result = markdown;\n  \n  for (const { prefix, suffix, prefixLen } of patternsToRemove) {\n    if (result.startsWith(prefix) && !result.endsWith(suffix)) {\n      result = result.slice(prefixLen);\n      break;  // remove prefix without suffix only once\n    }\n  }\n  \n  let changed = true;\n\n  while (changed) {\n    changed = false;\n    \n    for (const { prefix, suffix, prefixLen } of patternsToRemove) {\n      let startIndex = 0;\n      while ((startIndex = result.indexOf(prefix, startIndex)) !== -1) {\n        const endIndex = result.indexOf(suffix, startIndex + prefixLen);\n        if (endIndex !== -1) {\n          // only remove fully matched code blocks\n          const before = result.slice(0, startIndex);\n          const content = result.slice(startIndex + prefixLen, endIndex);\n          const after = result.slice(endIndex + suffix.length);\n          result = before + content + after;\n          changed = true;\n          startIndex = before.length + content.length;\n        } else {\n          startIndex += prefixLen;\n        }\n      }\n    }\n  }\n  \n  return result;\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3013, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/settings/tabs/about-en.md.js"],"sourcesContent":["export default \"# ðŸ“º [About DeepCraft](https://github.com/bytedance/deer-flow)\\n\\n> **From Open Source, Back to Open Source**\\n\\n**DeepCraft** (**D**eep **E**xploration and **E**fficient **R**esearch **Craft**) is a community-driven AI automation framework inspired by the remarkable contributions of the open source community. Our mission is to seamlessly integrate language models with specialized tools for tasks such as web search, crawling, and Python code executionâ€”all while giving back to the community that made this innovation possible.\\n\\n---\\n\\n## ðŸŒŸ GitHub Repository\\n\\nExplore DeepCraft on GitHub: [github.com/bytedance/deer-flow](https://github.com/bytedance/deer-flow)\\n\\n---\\n\\n## ðŸ“œ License\\n\\nDeepCraft is proudly open source and distributed under the **MIT License**.\\n\\n---\\n\\n## ðŸ™Œ Acknowledgments\\n\\nWe extend our heartfelt gratitude to the open source projects and contributors who have made DeerFlow a reality. We truly stand on the shoulders of giants.\\n\\n### Core Frameworks\\n- **[LangChain](https://github.com/langchain-ai/langchain)**: A phenomenal framework that powers our LLM interactions and chains.\\n- **[LangGraph](https://github.com/langchain-ai/langgraph)**: Enabling sophisticated multi-agent orchestration.\\n- **[Next.js](https://nextjs.org/)**: A cutting-edge framework for building web applications.\\n\\n### UI Libraries\\n- **[Shadcn](https://ui.shadcn.com/)**: Minimalistic components that power our UI.\\n- **[Zustand](https://zustand.docs.pmnd.rs/)**: A stunning state management library.\\n- **[Framer Motion](https://www.framer.com/motion/)**: An amazing animation library.\\n- **[React Markdown](https://www.npmjs.com/package/react-markdown)**: Exceptional markdown rendering with customizability.\\n- **[SToneX](https://github.com/stonexer)**: For his invaluable contribution to token-by-token visual effects.\\n\\nThese outstanding projects form the backbone of DeepCraft and exemplify the transformative power of open source collaboration.\\n\\n### Special Thanks\\nFinally, we want to express our heartfelt gratitude to the core authors of `DeepCraft`:\\n\\n- **[Daniel Walnut](https://github.com/hetaoBackend/)**\\n- **[Henry Li](https://github.com/magiccube/)**\\n\\nWithout their vision, passion and dedication, `DeepCraft` would not be what it is today.\\n\";"],"names":[],"mappings":";;;uCAAe","debugId":null}},
    {"offset": {"line": 3026, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/settings/tabs/about-zh.md.js"],"sourcesContent":["export default \"# ðŸ“º [å…³äºŽ DeepCraft](https://github.com/bytedance/deer-flow)\\n\\n> **æºäºŽå¼€æºï¼Œå›žé¦ˆå¼€æº**\\n\\n**DeepCraft**ï¼ˆ**æ·±åº¦æŽ¢ç´¢**å’Œ**é«˜æ•ˆç ”ç©¶**æµç¨‹ï¼‰æ˜¯ä¸€ä¸ªç”±ç¤¾åŒºé©±åŠ¨çš„ AI è‡ªåŠ¨åŒ–æ¡†æž¶ï¼Œå—åˆ°å¼€æºç¤¾åŒºå“è¶Šè´¡çŒ®çš„å¯å‘ã€‚æˆ‘ä»¬çš„ä½¿å‘½æ˜¯å°†è¯­è¨€æ¨¡åž‹ä¸Žä¸“ä¸šå·¥å…·æ— ç¼é›†æˆï¼Œç”¨äºŽç½‘ç»œæœç´¢ã€çˆ¬å–å’Œ Python ä»£ç æ‰§è¡Œç­‰ä»»åŠ¡â€”â€”åŒæ—¶å›žé¦ˆä½¿è¿™ç§åˆ›æ–°æˆä¸ºå¯èƒ½çš„ç¤¾åŒºã€‚\\n\\n---\\n\\n## ðŸŒŸ GitHub ä»“åº“\\n\\nåœ¨ GitHub ä¸ŠæŽ¢ç´¢ DeepCraftï¼š[github.com/bytedance/deer-flow](https://github.com/bytedance/deer-flow)\\n\\n---\\n\\n## ðŸ“œ è½¯ä»¶è®¸å¯è¯\\n\\nDeepCraft ä½œä¸ºå¼€æºé¡¹ç›®ï¼Œåœ¨ **MIT è®¸å¯è¯** ä¸‹åˆ†å‘ã€‚\\n\\n---\\n\\n## ðŸ™Œ è‡´è°¢\\n\\næˆ‘ä»¬è¡·å¿ƒæ„Ÿè°¢ä½¿ DeerFlow æˆä¸ºçŽ°å®žçš„å¼€æºé¡¹ç›®å’Œè´¡çŒ®è€…ã€‚æˆ‘ä»¬çœŸæ­£ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šã€‚\\n\\n### æ ¸å¿ƒæ¡†æž¶\\n- **[LangChain](https://github.com/langchain-ai/langchain)**ï¼šæ”¯æŒæˆ‘ä»¬ LLM äº¤äº’å’Œé“¾çš„å“è¶Šæ¡†æž¶ã€‚\\n- **[LangGraph](https://github.com/langchain-ai/langgraph)**ï¼šå®žçŽ°å¤æ‚çš„å¤šæ™ºèƒ½ä½“ç¼–æŽ’ã€‚\\n- **[Next.js](https://nextjs.org/)**ï¼šæž„å»º Web åº”ç”¨ç¨‹åºçš„å‰æ²¿æ¡†æž¶ã€‚\\n\\n### UI åº“\\n- **[Shadcn](https://ui.shadcn.com/)**ï¼šæ”¯æŒæˆ‘ä»¬ UI çš„ç®€çº¦ç»„ä»¶ã€‚\\n- **[Zustand](https://zustand.docs.pmnd.rs/)**ï¼šä»¤äººæƒŠå¹çš„çŠ¶æ€ç®¡ç†åº“ã€‚\\n- **[Framer Motion](https://www.framer.com/motion/)**ï¼šå‡ºè‰²çš„åŠ¨ç”»åº“ã€‚\\n- **[React Markdown](https://www.npmjs.com/package/react-markdown)**ï¼šå…·æœ‰å¯å®šåˆ¶æ€§çš„å“è¶Š markdown æ¸²æŸ“ã€‚\\n- **[SToneX](https://github.com/stonexer)**ï¼šæ„Ÿè°¢ä»–å¯¹é€å­—ç¬¦è§†è§‰æ•ˆæžœçš„å®è´µè´¡çŒ®ã€‚\\n\\nè¿™äº›æ°å‡ºçš„é¡¹ç›®æž„æˆäº† DeepCraft çš„éª¨å¹²ï¼Œä½“çŽ°äº†å¼€æºåä½œçš„å˜é©åŠ›é‡ã€‚\\n\\n### ç‰¹åˆ«æ„Ÿè°¢\\næœ€åŽï¼Œæˆ‘ä»¬è¦å‘ `DeepCraft` çš„æ ¸å¿ƒä½œè€…è¡¨è¾¾è¡·å¿ƒçš„æ„Ÿè°¢ï¼š\\n\\n- **[Daniel Walnut](https://github.com/hetaoBackend/)**\\n- **[Henry Li](https://github.com/magiccube/)**\\n\\næ²¡æœ‰ä»–ä»¬çš„æ„¿æ™¯ã€çƒ­æƒ…å’Œå¥‰çŒ®ï¼Œ`DeepCraft` å°±ä¸ä¼šæœ‰ä»Šå¤©çš„æˆå°±ã€‚\\n\";"],"names":[],"mappings":";;;uCAAe","debugId":null}},
    {"offset": {"line": 3039, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/settings/tabs/about-tab.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { BadgeInfo } from \"lucide-react\";\nimport { useLocale, useTranslations } from \"next-intl\";\n\nimport { Markdown } from \"~/components/deer-flow/markdown\";\n\nimport aboutEn from \"./about-en.md\";\nimport aboutZh from \"./about-zh.md\";\nimport type { Tab } from \"./types\";\n\nexport const AboutTab: Tab = () => {\n  const locale = useLocale();\n  //const t = useTranslations(\"settings.about\");\n\n  const aboutContent = locale === \"zh\" ? aboutZh : aboutEn;\n\n  return <Markdown>{aboutContent}</Markdown>;\n};\nAboutTab.icon = BadgeInfo;\nAboutTab.displayName = \"About\";\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;AAE/B;AACA;AAEA;AAEA;AACA;;;;;;;;AAGO,MAAM,WAAgB;;IAC3B,MAAM,SAAS,CAAA,GAAA,mPAAA,CAAA,YAAS,AAAD;IACvB,8CAA8C;IAE9C,MAAM,eAAe,WAAW,OAAO,sJAAA,CAAA,UAAO,GAAG,sJAAA,CAAA,UAAO;IAExD,qBAAO,sYAAC,iJAAA,CAAA,WAAQ;kBAAE;;;;;;AACpB;GAPa;;QACI,mPAAA,CAAA,YAAS;;;KADb;AAQb,SAAS,IAAI,GAAG,uSAAA,CAAA,YAAS;AACzB,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 3089, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"~/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,KAGoC;QAHpC,EACb,SAAS,EACT,GAAG,OAC8C,GAHpC;IAIb,qBACE,sYAAC,wXAAA,CAAA,OAAmB;QAClB,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS","debugId":null}},
    {"offset": {"line": 3124, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/form.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  useFormState,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"~/lib/utils\"\nimport { Label } from \"~/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState } = useFormContext()\n  const formState = useFormState({ name: fieldContext.name })\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nfunction FormItem({ className, ...props }: React.ComponentProps<\"div\">) {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div\n        data-slot=\"form-item\"\n        className={cn(\"grid gap-2\", className)}\n        {...props}\n      />\n    </FormItemContext.Provider>\n  )\n}\n\nfunction FormLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      data-slot=\"form-label\"\n      data-error={!!error}\n      className={cn(\"data-[error=true]:text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n}\n\nfunction FormControl({ ...props }: React.ComponentProps<typeof Slot>) {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      data-slot=\"form-control\"\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n}\n\nfunction FormDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      data-slot=\"form-description\"\n      id={formDescriptionId}\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction FormMessage({ className, ...props }: React.ComponentProps<\"p\">) {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : props.children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      data-slot=\"form-message\"\n      id={formMessageId}\n      className={cn(\"text-destructive text-sm\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n}\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3333, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"~/lib/utils\"\n\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        \"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        \"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]\",\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;AAEA;;;AAEA,SAAS,MAAM,KAA4D;QAA5D,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC,GAA5D;IACb,qBACE,sYAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,mcACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS","debugId":null}},
    {"offset": {"line": 3366, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitive from \"@radix-ui/react-switch\"\n\nimport { cn } from \"~/lib/utils\"\n\nfunction Switch({\n  className,\n  ...props\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\n  return (\n    <SwitchPrimitive.Root\n      data-slot=\"switch\"\n      className={cn(\n        \"peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <SwitchPrimitive.Thumb\n        data-slot=\"switch-thumb\"\n        className={cn(\n          \"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0\"\n        )}\n      />\n    </SwitchPrimitive.Root>\n  )\n}\n\nexport { Switch }\n"],"names":[],"mappings":";;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,KAGoC;QAHpC,EACd,SAAS,EACT,GAAG,OAC+C,GAHpC;IAId,qBACE,sYAAC,yXAAA,CAAA,OAAoB;QACnB,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,6WACA;QAED,GAAG,KAAK;kBAET,cAAA,sYAAC,yXAAA,CAAA,QAAqB;YACpB,aAAU;YACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV;;;;;;;;;;;AAKV;KArBS","debugId":null}},
    {"offset": {"line": 3409, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/settings/tabs/general-tab.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Settings } from \"lucide-react\";\nimport { useTranslations } from \"next-intl\";\nimport { useEffect, useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { z } from \"zod\";\n\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"~/components/ui/form\";\nimport { Input } from \"~/components/ui/input\";\nimport { Label } from \"~/components/ui/label\";\nimport { Switch } from \"~/components/ui/switch\";\nimport type { SettingsState } from \"~/core/store\";\n\nimport type { Tab } from \"./types\";\n\nconst generalFormSchema = z.object({\n  autoAcceptedPlan: z.boolean(),\n  enableClarification: z.boolean(),\n  maxClarificationRounds: z.number().min(1, {\n    message: \"Max clarification rounds must be at least 1.\",\n  }),\n  maxPlanIterations: z.number().min(1, {\n    message: \"Max plan iterations must be at least 1.\",\n  }),\n  maxStepNum: z.number().min(1, {\n    message: \"Max step number must be at least 1.\",\n  }),\n  maxSearchResults: z.number().min(1, {\n    message: \"Max search results must be at least 1.\",\n  }),\n  // Others\n  enableBackgroundInvestigation: z.boolean(),\n  enableDeepThinking: z.boolean(),\n  reportStyle: z.enum([\"academic\", \"popular_science\", \"news\", \"social_media\",\"strategic_investment\"]),\n});\n\nexport const GeneralTab: Tab = ({\n  settings,\n  onChange,\n}: {\n  settings: SettingsState;\n  onChange: (changes: Partial<SettingsState>) => void;\n}) => {\n  const t = useTranslations(\"settings.general\");\n  const generalSettings = useMemo(() => settings.general, [settings]);\n  const form = useForm<z.infer<typeof generalFormSchema>>({\n    resolver: zodResolver(generalFormSchema, undefined, undefined),\n    defaultValues: generalSettings,\n    mode: \"all\",\n    reValidateMode: \"onBlur\",\n  });\n\n  const currentSettings = form.watch();\n  useEffect(() => {\n    let hasChanges = false;\n    for (const key in currentSettings) {\n      if (\n        currentSettings[key as keyof typeof currentSettings] !==\n        settings.general[key as keyof SettingsState[\"general\"]]\n      ) {\n        hasChanges = true;\n        break;\n      }\n    }\n    if (hasChanges) {\n      onChange({ general: currentSettings });\n    }\n  }, [currentSettings, onChange, settings]);\n\n  return (\n    <div className=\"flex flex-col gap-4\">\n      <header>\n        <h1 className=\"text-lg font-medium\">{t(\"title\")}</h1>\n      </header>\n      <main>\n        <Form {...form}>\n          <form className=\"space-y-8\">\n            <FormField\n              control={form.control}\n              name=\"autoAcceptedPlan\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormControl>\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        id=\"autoAcceptedPlan\"\n                        checked={field.value}\n                        onCheckedChange={field.onChange}\n                      />\n                      <Label className=\"text-sm\" htmlFor=\"autoAcceptedPlan\">\n                        {t(\"autoAcceptPlan\")}\n                      </Label>\n                    </div>\n                  </FormControl>\n                </FormItem>\n              )}\n            />\n            <FormField\n              control={form.control}\n              name=\"enableClarification\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormControl>\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        id=\"enableClarification\"\n                        checked={field.value}\n                        onCheckedChange={field.onChange}\n                      />\n                      <Label className=\"text-sm\" htmlFor=\"enableClarification\">\n                        {t(\"enableClarification\")} {field.value ? \"(On)\" : \"(Off)\"}\n                      </Label>\n                    </div>\n                  </FormControl>\n                </FormItem>\n              )}\n            />\n            {form.watch(\"enableClarification\") && (\n              <FormField\n                control={form.control}\n                name=\"maxClarificationRounds\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>{t(\"maxClarificationRounds\")}</FormLabel>\n                    <FormControl>\n                      <Input\n                        className=\"w-60\"\n                        type=\"number\"\n                        defaultValue={field.value}\n                        min={1}\n                        onChange={(event) =>\n                          field.onChange(parseInt(event.target.value || \"1\"))\n                        }\n                      />\n                    </FormControl>\n                    <FormDescription>\n                      {t(\"maxClarificationRoundsDescription\")}\n                    </FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            )}\n            <FormField\n              control={form.control}\n              name=\"maxPlanIterations\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>{t(\"maxPlanIterations\")}</FormLabel>\n                  <FormControl>\n                    <Input\n                      className=\"w-60\"\n                      type=\"number\"\n                      defaultValue={field.value}\n                      min={1}\n                      onChange={(event) =>\n                        field.onChange(parseInt(event.target.value || \"0\"))\n                      }\n                    />\n                  </FormControl>\n                  <FormDescription>\n                    {t(\"maxPlanIterationsDescription\")}\n                  </FormDescription>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n            <FormField\n              control={form.control}\n              name=\"maxStepNum\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>{t(\"maxStepsOfPlan\")}</FormLabel>\n                  <FormControl>\n                    <Input\n                      className=\"w-60\"\n                      type=\"number\"\n                      defaultValue={field.value}\n                      min={1}\n                      onChange={(event) =>\n                        field.onChange(parseInt(event.target.value || \"0\"))\n                      }\n                    />\n                  </FormControl>\n                  <FormDescription>{t(\"maxStepsDescription\")}</FormDescription>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n            <FormField\n              control={form.control}\n              name=\"maxSearchResults\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>{t(\"maxSearchResults\")}</FormLabel>\n                  <FormControl>\n                    <Input\n                      className=\"w-60\"\n                      type=\"number\"\n                      defaultValue={field.value}\n                      min={1}\n                      onChange={(event) =>\n                        field.onChange(parseInt(event.target.value || \"0\"))\n                      }\n                    />\n                  </FormControl>\n                  <FormDescription>\n                    {t(\"maxSearchResultsDescription\")}\n                  </FormDescription>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n          </form>\n        </Form>\n      </main>\n    </div>\n  );\n};\nGeneralTab.displayName = \"General\";\nGeneralTab.icon = Settings;\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;AAE/B;AACA;AACA;AACA;AACA;AACA;AAEA;AASA;AACA;AACA;;;;;;;;;;;;;AAKA,MAAM,oBAAoB,wLAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACjC,kBAAkB,wLAAA,CAAA,IAAC,CAAC,OAAO;IAC3B,qBAAqB,wLAAA,CAAA,IAAC,CAAC,OAAO;IAC9B,wBAAwB,wLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QACxC,SAAS;IACX;IACA,mBAAmB,wLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QACnC,SAAS;IACX;IACA,YAAY,wLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAC5B,SAAS;IACX;IACA,kBAAkB,wLAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;QAClC,SAAS;IACX;IACA,SAAS;IACT,+BAA+B,wLAAA,CAAA,IAAC,CAAC,OAAO;IACxC,oBAAoB,wLAAA,CAAA,IAAC,CAAC,OAAO;IAC7B,aAAa,wLAAA,CAAA,IAAC,CAAC,IAAI,CAAC;QAAC;QAAY;QAAmB;QAAQ;QAAe;KAAuB;AACpG;AAEO,MAAM,aAAkB;QAAC,EAC9B,QAAQ,EACR,QAAQ,EAIT;;IACC,MAAM,IAAI,CAAA,GAAA,8ZAAA,CAAA,kBAAe,AAAD,EAAE;IAC1B,MAAM,kBAAkB,CAAA,GAAA,sWAAA,CAAA,UAAO,AAAD;+CAAE,IAAM,SAAS,OAAO;8CAAE;QAAC;KAAS;IAClE,MAAM,OAAO,CAAA,GAAA,0PAAA,CAAA,UAAO,AAAD,EAAqC;QACtD,UAAU,CAAA,GAAA,kSAAA,CAAA,cAAW,AAAD,EAAE,mBAAmB,WAAW;QACpD,eAAe;QACf,MAAM;QACN,gBAAgB;IAClB;IAEA,MAAM,kBAAkB,KAAK,KAAK;IAClC,CAAA,GAAA,sWAAA,CAAA,YAAS,AAAD;gCAAE;YACR,IAAI,aAAa;YACjB,IAAK,MAAM,OAAO,gBAAiB;gBACjC,IACE,eAAe,CAAC,IAAoC,KACpD,SAAS,OAAO,CAAC,IAAsC,EACvD;oBACA,aAAa;oBACb;gBACF;YACF;YACA,IAAI,YAAY;gBACd,SAAS;oBAAE,SAAS;gBAAgB;YACtC;QACF;+BAAG;QAAC;QAAiB;QAAU;KAAS;IAExC,qBACE,sYAAC;QAAI,WAAU;;0BACb,sYAAC;0BACC,cAAA,sYAAC;oBAAG,WAAU;8BAAuB,EAAE;;;;;;;;;;;0BAEzC,sYAAC;0BACC,cAAA,sYAAC,mIAAA,CAAA,OAAI;oBAAE,GAAG,IAAI;8BACZ,cAAA,sYAAC;wBAAK,WAAU;;0CACd,sYAAC,mIAAA,CAAA,YAAS;gCACR,SAAS,KAAK,OAAO;gCACrB,MAAK;gCACL,QAAQ;wCAAC,EAAE,KAAK,EAAE;yDAChB,sYAAC,mIAAA,CAAA,WAAQ;kDACP,cAAA,sYAAC,mIAAA,CAAA,cAAW;sDACV,cAAA,sYAAC;gDAAI,WAAU;;kEACb,sYAAC,qIAAA,CAAA,SAAM;wDACL,IAAG;wDACH,SAAS,MAAM,KAAK;wDACpB,iBAAiB,MAAM,QAAQ;;;;;;kEAEjC,sYAAC,oIAAA,CAAA,QAAK;wDAAC,WAAU;wDAAU,SAAQ;kEAChC,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;0CAOf,sYAAC,mIAAA,CAAA,YAAS;gCACR,SAAS,KAAK,OAAO;gCACrB,MAAK;gCACL,QAAQ;wCAAC,EAAE,KAAK,EAAE;yDAChB,sYAAC,mIAAA,CAAA,WAAQ;kDACP,cAAA,sYAAC,mIAAA,CAAA,cAAW;sDACV,cAAA,sYAAC;gDAAI,WAAU;;kEACb,sYAAC,qIAAA,CAAA,SAAM;wDACL,IAAG;wDACH,SAAS,MAAM,KAAK;wDACpB,iBAAiB,MAAM,QAAQ;;;;;;kEAEjC,sYAAC,oIAAA,CAAA,QAAK;wDAAC,WAAU;wDAAU,SAAQ;;4DAChC,EAAE;4DAAuB;4DAAE,MAAM,KAAK,GAAG,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4BAO9D,KAAK,KAAK,CAAC,wCACV,sYAAC,mIAAA,CAAA,YAAS;gCACR,SAAS,KAAK,OAAO;gCACrB,MAAK;gCACL,QAAQ;wCAAC,EAAE,KAAK,EAAE;yDAChB,sYAAC,mIAAA,CAAA,WAAQ;;0DACP,sYAAC,mIAAA,CAAA,YAAS;0DAAE,EAAE;;;;;;0DACd,sYAAC,mIAAA,CAAA,cAAW;0DACV,cAAA,sYAAC,oIAAA,CAAA,QAAK;oDACJ,WAAU;oDACV,MAAK;oDACL,cAAc,MAAM,KAAK;oDACzB,KAAK;oDACL,UAAU,CAAC,QACT,MAAM,QAAQ,CAAC,SAAS,MAAM,MAAM,CAAC,KAAK,IAAI;;;;;;;;;;;0DAIpD,sYAAC,mIAAA,CAAA,kBAAe;0DACb,EAAE;;;;;;0DAEL,sYAAC,mIAAA,CAAA,cAAW;;;;;;;;;;;;;;;;;0CAKpB,sYAAC,mIAAA,CAAA,YAAS;gCACR,SAAS,KAAK,OAAO;gCACrB,MAAK;gCACL,QAAQ;wCAAC,EAAE,KAAK,EAAE;yDAChB,sYAAC,mIAAA,CAAA,WAAQ;;0DACP,sYAAC,mIAAA,CAAA,YAAS;0DAAE,EAAE;;;;;;0DACd,sYAAC,mIAAA,CAAA,cAAW;0DACV,cAAA,sYAAC,oIAAA,CAAA,QAAK;oDACJ,WAAU;oDACV,MAAK;oDACL,cAAc,MAAM,KAAK;oDACzB,KAAK;oDACL,UAAU,CAAC,QACT,MAAM,QAAQ,CAAC,SAAS,MAAM,MAAM,CAAC,KAAK,IAAI;;;;;;;;;;;0DAIpD,sYAAC,mIAAA,CAAA,kBAAe;0DACb,EAAE;;;;;;0DAEL,sYAAC,mIAAA,CAAA,cAAW;;;;;;;;;;;;;;;;;0CAIlB,sYAAC,mIAAA,CAAA,YAAS;gCACR,SAAS,KAAK,OAAO;gCACrB,MAAK;gCACL,QAAQ;wCAAC,EAAE,KAAK,EAAE;yDAChB,sYAAC,mIAAA,CAAA,WAAQ;;0DACP,sYAAC,mIAAA,CAAA,YAAS;0DAAE,EAAE;;;;;;0DACd,sYAAC,mIAAA,CAAA,cAAW;0DACV,cAAA,sYAAC,oIAAA,CAAA,QAAK;oDACJ,WAAU;oDACV,MAAK;oDACL,cAAc,MAAM,KAAK;oDACzB,KAAK;oDACL,UAAU,CAAC,QACT,MAAM,QAAQ,CAAC,SAAS,MAAM,MAAM,CAAC,KAAK,IAAI;;;;;;;;;;;0DAIpD,sYAAC,mIAAA,CAAA,kBAAe;0DAAE,EAAE;;;;;;0DACpB,sYAAC,mIAAA,CAAA,cAAW;;;;;;;;;;;;;;;;;0CAIlB,sYAAC,mIAAA,CAAA,YAAS;gCACR,SAAS,KAAK,OAAO;gCACrB,MAAK;gCACL,QAAQ;wCAAC,EAAE,KAAK,EAAE;yDAChB,sYAAC,mIAAA,CAAA,WAAQ;;0DACP,sYAAC,mIAAA,CAAA,YAAS;0DAAE,EAAE;;;;;;0DACd,sYAAC,mIAAA,CAAA,cAAW;0DACV,cAAA,sYAAC,oIAAA,CAAA,QAAK;oDACJ,WAAU;oDACV,MAAK;oDACL,cAAc,MAAM,KAAK;oDACzB,KAAK;oDACL,UAAU,CAAC,QACT,MAAM,QAAQ,CAAC,SAAS,MAAM,MAAM,CAAC,KAAK,IAAI;;;;;;;;;;;0DAIpD,sYAAC,mIAAA,CAAA,kBAAe;0DACb,EAAE;;;;;;0DAEL,sYAAC,mIAAA,CAAA,cAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS9B;GAtLa;;QAOD,8ZAAA,CAAA,kBAAe;QAEZ,0PAAA,CAAA,UAAO;;;KATT;AAuLb,WAAW,WAAW,GAAG;AACzB,WAAW,IAAI,GAAG,iSAAA,CAAA,WAAQ","debugId":null}},
    {"offset": {"line": 3889, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"~/lib/utils\"\n\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;AAEA;;;AAEA,SAAS,SAAS,KAAyD;QAAzD,EAAE,SAAS,EAAE,GAAG,OAAyC,GAAzD;IAChB,qBACE,sYAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,ucACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS","debugId":null}},
    {"offset": {"line": 3921, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/mcp/schema.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { z } from \"zod\";\n\nexport const MCPConfigSchema = z.object({\n  mcpServers: z.record(\n    z.union(\n      [\n        z.object({\n          command: z.string({\n            message: \"`command` must be a string\",\n          }),\n          args: z\n            .array(z.string(), {\n              message: \"`args` must be an array of strings\",\n            })\n            .optional(),\n          env: z\n            .record(z.string(), {\n              message: \"`env` must be an object of key-value pairs\",\n            })\n            .optional(),\n        }),\n        z.object({\n          url: z\n            .string({\n              message:\n                \"`url` must be a valid URL starting with http:// or https://\",\n            })\n            .refine(\n              (value) => {\n                try {\n                  const url = new URL(value);\n                  return url.protocol === \"http:\" || url.protocol === \"https:\";\n                } catch {\n                  return false;\n                }\n              },\n              {\n                message:\n                  \"`url` must be a valid URL starting with http:// or https://\",\n              },\n            ),\n          env: z\n            .record(z.string(), {\n              message: \"`env` must be an object of key-value pairs\",\n            })\n            .optional(),\n          transport: z\n            .enum([\"sse\", \"streamable_http\"], {\n              message: \"transport must be either sse or streamable_http\"\n            })\n            .default(\"sse\"),\n        }),\n      ],\n      {\n        message: \"Invalid server type\",\n      },\n    ),\n  ),\n});\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAE/B;;AAEO,MAAM,kBAAkB,wLAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACtC,YAAY,wLAAA,CAAA,IAAC,CAAC,MAAM,CAClB,wLAAA,CAAA,IAAC,CAAC,KAAK,CACL;QACE,wLAAA,CAAA,IAAC,CAAC,MAAM,CAAC;YACP,SAAS,wLAAA,CAAA,IAAC,CAAC,MAAM,CAAC;gBAChB,SAAS;YACX;YACA,MAAM,wLAAA,CAAA,IAAC,CACJ,KAAK,CAAC,wLAAA,CAAA,IAAC,CAAC,MAAM,IAAI;gBACjB,SAAS;YACX,GACC,QAAQ;YACX,KAAK,wLAAA,CAAA,IAAC,CACH,MAAM,CAAC,wLAAA,CAAA,IAAC,CAAC,MAAM,IAAI;gBAClB,SAAS;YACX,GACC,QAAQ;QACb;QACA,wLAAA,CAAA,IAAC,CAAC,MAAM,CAAC;YACP,KAAK,wLAAA,CAAA,IAAC,CACH,MAAM,CAAC;gBACN,SACE;YACJ,GACC,MAAM,CACL,CAAC;gBACC,IAAI;oBACF,MAAM,MAAM,IAAI,IAAI;oBACpB,OAAO,IAAI,QAAQ,KAAK,WAAW,IAAI,QAAQ,KAAK;gBACtD,EAAE,UAAM;oBACN,OAAO;gBACT;YACF,GACA;gBACE,SACE;YACJ;YAEJ,KAAK,wLAAA,CAAA,IAAC,CACH,MAAM,CAAC,wLAAA,CAAA,IAAC,CAAC,MAAM,IAAI;gBAClB,SAAS;YACX,GACC,QAAQ;YACX,WAAW,wLAAA,CAAA,IAAC,CACT,IAAI,CAAC;gBAAC;gBAAO;aAAkB,EAAE;gBAChC,SAAS;YACX,GACC,OAAO,CAAC;QACb;KACD,EACD;QACE,SAAS;IACX;AAGN","debugId":null}},
    {"offset": {"line": 3977, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/mcp/types.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport interface MCPToolMetadata {\n  name: string;\n  description: string;\n  inputSchema?: Record<string, unknown>;\n}\n\nexport interface GenericMCPServerMetadata<T extends string> {\n  name: string;\n  transport: T;\n  enabled: boolean;\n  env?: Record<string, string>;\n  headers?: Record<string, string>;\n  tools: MCPToolMetadata[];\n  createdAt: number;\n  updatedAt: number;\n}\n\nexport interface StdioMCPServerMetadata\n  extends GenericMCPServerMetadata<\"stdio\"> {\n  transport: \"stdio\";\n  command: string;\n  args?: string[];\n}\nexport type SimpleStdioMCPServerMetadata = Omit<\n  StdioMCPServerMetadata,\n  \"enabled\" | \"tools\" | \"createdAt\" | \"updatedAt\"\n>;\n\nexport interface SSEMCPServerMetadata\n  extends GenericMCPServerMetadata<\"sse\" | \"streamable_http\"> {\n  transport: \"sse\" | \"streamable_http\";\n  url: string;\n}\n\nexport type SimpleSSEMCPServerMetadata = Omit<\n  SSEMCPServerMetadata,\n  \"enabled\" | \"tools\" | \"createdAt\" | \"updatedAt\"\n>;\n\nexport type MCPServerMetadata = StdioMCPServerMetadata | SSEMCPServerMetadata;\nexport type SimpleMCPServerMetadata =\n  | SimpleStdioMCPServerMetadata\n  | SimpleSSEMCPServerMetadata;\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B","debugId":null}},
    {"offset": {"line": 3990, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/mcp/utils.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { useSettingsStore } from \"../store\";\n\nexport function findMCPTool(name: string) {\n  const mcpServers = useSettingsStore.getState().mcp.servers;\n  for (const server of mcpServers) {\n    for (const tool of server.tools) {\n      if (tool.name === name) {\n        return tool;\n      }\n    }\n  }\n  return null;\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;AAE/B;AAAA;;AAEO,SAAS,YAAY,IAAY;IACtC,MAAM,aAAa,4IAAA,CAAA,mBAAgB,CAAC,QAAQ,GAAG,GAAG,CAAC,OAAO;IAC1D,KAAK,MAAM,UAAU,WAAY;QAC/B,KAAK,MAAM,QAAQ,OAAO,KAAK,CAAE;YAC/B,IAAI,KAAK,IAAI,KAAK,MAAM;gBACtB,OAAO;YACT;QACF;IACF;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 4018, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/core/mcp/index.ts"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nexport * from \"./schema\";\nexport * from \"./types\";\nexport * from \"./utils\";\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;AAE/B;AACA;AACA","debugId":null}},
    {"offset": {"line": 4045, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/settings/dialogs/add-mcp-server-dialog.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { Loader2 } from \"lucide-react\";\nimport { useTranslations } from \"next-intl\";\nimport { useCallback, useRef, useState } from \"react\";\n\nimport { Button } from \"~/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\";\nimport { Textarea } from \"~/components/ui/textarea\";\nimport { queryMCPServerMetadata } from \"~/core/api\";\nimport {\n  MCPConfigSchema,\n  type MCPServerMetadata,\n  type SimpleMCPServerMetadata,\n  type SimpleSSEMCPServerMetadata,\n  type SimpleStdioMCPServerMetadata,\n} from \"~/core/mcp\";\n\nexport function AddMCPServerDialog({\n  onAdd,\n}: {\n  onAdd?: (servers: MCPServerMetadata[]) => void;\n}) {\n  const t = useTranslations(\"settings\");\n  const [open, setOpen] = useState(false);\n  const [input, setInput] = useState(\"\");\n  const [validationError, setValidationError] = useState<string | null>(\"\");\n  const [error, setError] = useState<string | null>(null);\n  const [processing, setProcessing] = useState(false);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  const handleChange = useCallback((value: string) => {\n    setInput(value);\n    if (!value.trim()) {\n      setValidationError(null);\n      return;\n    }\n    setValidationError(null);\n    try {\n      const parsed = JSON.parse(value);\n      if (!(\"mcpServers\" in parsed)) {\n        setValidationError(\"Missing `mcpServers` in JSON\");\n        return;\n      }\n    } catch {\n      setValidationError(t(\"invalidJson\"));\n      return;\n    }\n    const result = MCPConfigSchema.safeParse(JSON.parse(value));\n    if (!result.success) {\n      if (result.error.errors[0]) {\n        const error = result.error.errors[0];\n        if (error.code === \"invalid_union\") {\n          if (error.unionErrors[0]?.errors[0]) {\n            setValidationError(error.unionErrors[0].errors[0].message);\n            return;\n          }\n        }\n      }\n      const errorMessage =\n        result.error.errors[0]?.message ?? t(\"validationFailed\");\n      setValidationError(errorMessage);\n      return;\n    }\n\n    const keys = Object.keys(result.data.mcpServers);\n    if (keys.length === 0) {\n      setValidationError(t(\"missingServerName\"));\n      return;\n    }\n  }, [t]);\n\n  const handleAdd = useCallback(async () => {\n    abortControllerRef.current = new AbortController();\n    const config = MCPConfigSchema.parse(JSON.parse(input));\n    setInput(JSON.stringify(config, null, 2));\n    const addingServers: SimpleMCPServerMetadata[] = [];\n    for (const [key, server] of Object.entries(config.mcpServers)) {\n      if (\"command\" in server) {\n        const metadata: SimpleStdioMCPServerMetadata = {\n          transport: \"stdio\",\n          name: key,\n          command: server.command,\n          args: server.args,\n          env: server.env,\n        };\n        addingServers.push(metadata);\n      } else if (\"url\" in server) {\n        const metadata: SimpleSSEMCPServerMetadata = {\n          transport: server.transport,\n          name: key,\n          url: server.url,\n        };\n        addingServers.push(metadata);\n      }\n    }\n    setProcessing(true);\n\n    const results: MCPServerMetadata[] = [];\n    let processingServer: string | null = null;\n    try {\n      setError(null);\n      for (const server of addingServers) {\n        processingServer = server.name;\n        const metadata = await queryMCPServerMetadata(server, abortControllerRef.current.signal);\n        results.push({ ...metadata, name: server.name, enabled: true });\n      }\n      if (results.length > 0) {\n        onAdd?.(results);\n      }\n      setInput(\"\");\n      setOpen(false);\n    } catch (e) {\n      console.error(e);\n      if (e instanceof Error && e.name === 'AbortError') {\n        setError(`Request was cancelled`);\n      } else {\n        setError(`Failed to add server: ${processingServer}`);\n      }\n    } finally {\n      setProcessing(false);\n      abortControllerRef.current = null;\n    }\n  }, [input, onAdd]);\n\n  const handleAbort = () => {\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button size=\"sm\">{t(\"addServers\")}</Button>\n      </DialogTrigger>\n      <DialogContent className=\"sm:max-w-[560px]\">\n        <DialogHeader>\n          <DialogTitle>{t(\"addNewMCPServers\")}</DialogTitle>\n        </DialogHeader>\n        <DialogDescription>\n          {t(\"mcpConfigDescription\")}\n          <br />\n          {t(\"pasteConfigBelow\")}\n        </DialogDescription>\n\n        <main>\n          <Textarea\n            className=\"h-[360px] break-all sm:max-w-[510px]\"\n            placeholder={\n              'Example:\\n\\n{\\n  \"mcpServers\": {\\n    \"My Server\": {\\n      \"command\": \"python\",\\n      \"args\": [\\n        \"-m\", \"mcp_server\"\\n      ],\\n      \"env\": {\\n        \"API_KEY\": \"YOUR_API_KEY\"\\n      }\\n    }\\n  }\\n}'\n            }\n            value={input}\n            onChange={(e) => handleChange(e.target.value)}\n          />\n        </main>\n\n        <DialogFooter>\n          <div className=\"flex h-10 w-full items-center justify-between gap-2\">\n            <div className=\"text-destructive flex-grow overflow-hidden text-sm\">\n              {validationError ?? error}\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Button variant=\"outline\" onClick={() => setOpen(false)}>\n                {t(\"cancel\", { defaultValue: \"Cancel\" })}\n              </Button>\n              <Button\n                className=\"w-24\"\n                type=\"submit\"\n                disabled={!input.trim() || !!validationError || processing}\n                onClick={handleAdd}\n              >\n                {processing && <Loader2 className=\"animate-spin\" />}\n                {t(\"add\")}\n              </Button>\n              {\n                processing && (\n                  <Button variant=\"destructive\" onClick={handleAbort}>Abort</Button>\n                )\n              }\n            </div>\n          </div>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4359, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/settings/dialogs/edit-mcp-server-dialog.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { Loader2 } from \"lucide-react\";\nimport { useTranslations } from \"next-intl\";\nimport { useCallback, useState } from \"react\";\n\nimport { Button } from \"~/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\";\nimport { Textarea } from \"~/components/ui/textarea\";\nimport type { MCPServerMetadata } from \"~/core/mcp\";\nimport { MCPConfigSchema } from \"~/core/mcp\";\n\nexport function EditMCPServerDialog({\n  server,\n  onSave,\n  open,\n  onOpenChange,\n}: {\n  server: MCPServerMetadata;\n  onSave: (config: string) => Promise<boolean>;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}) {\n  const t = useTranslations(\"settings.mcp\");\n  const commonT = useTranslations(\"common\");\n  const [config, setConfig] = useState(\n    JSON.stringify(\n      {\n        mcpServers: {\n          [server.name]: server.transport === 'stdio'\n            ? {\n              command: server.command,\n              args: server.args,\n              env: server.env,\n            }\n            : {\n              transport: server.transport,\n              url: server.url,\n              headers: server.headers,\n            },\n        },\n      },\n      null,\n      2\n    )\n  );\n  const [processing, setProcessing] = useState(false);\n  const [validationError, setValidationError] = useState<string | null>(null);\n\n  const handleChange = useCallback((value: string) => {\n    setConfig(value);\n    setValidationError(null);\n\n    if (!value.trim()) {\n      return;\n    }\n\n    try {\n      const parsed = JSON.parse(value);\n      if (!(\"mcpServers\" in parsed)) {\n        setValidationError(\"Missing `mcpServers` in JSON\");\n        return;\n      }\n\n      const result = MCPConfigSchema.safeParse(parsed);\n      if (!result.success) {\n        if (result.error.errors[0]) {\n          const error = result.error.errors[0];\n          if (error.code === \"invalid_union\") {\n            if (error.unionErrors[0]?.errors[0]) {\n              setValidationError(error.unionErrors[0].errors[0].message);\n              return;\n            }\n          }\n          setValidationError(error.message || t(\"validationFailed\"));\n          return;\n        }\n      }\n\n      const keys = Object.keys(parsed.mcpServers);\n      if (keys.length === 0) {\n        setValidationError(t(\"missingServerName\"));\n      }\n    } catch {\n      setValidationError(t(\"invalidJson\"));\n    }\n  }, [t]);\n\n  const handleSave = useCallback(async () => {\n    setProcessing(true);\n    try {\n      const success = await onSave(config);\n      if (success) {\n        onOpenChange(false);\n      }\n    } catch (error) {\n      console.error('Failed to save server configuration:', error);\n    } finally {\n      setProcessing(false);\n    }\n  }, [config, onSave, onOpenChange]);\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[560px]\">\n        <DialogHeader>\n          <DialogTitle>{t(\"editServer\")}</DialogTitle>\n          <DialogDescription>\n            {t(\"editServerDescription\")}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <Textarea\n            className=\"h-[360px] font-mono text-sm\"\n            value={config}\n            onChange={(e) => handleChange(e.target.value)}\n          />\n          {validationError && (\n            <div className=\"text-sm text-red-500 mt-2\">\n              {validationError}\n            </div>\n          )}\n        </div>\n\n        <DialogFooter>\n          <div className=\"flex w-full justify-between items-center\">\n            <div className=\"text-sm text-muted-foreground\">\n              {t(\"editServerNote\")}\n            </div>\n            <div className=\"space-x-2\">\n              <Button\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                disabled={processing}\n              >\n                {commonT(\"cancel\")}\n              </Button>\n              <Button\n                onClick={handleSave}\n                disabled={processing || !!validationError}\n              >\n                {processing && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                {commonT(\"save\")}\n              </Button>\n            </div>\n          </div>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4604, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/settings/tabs/mcp-tab.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { motion } from \"framer-motion\";\nimport { Blocks, Edit2, PencilRuler, RefreshCw, Trash } from \"lucide-react\";\nimport { useTranslations } from \"next-intl\";\nimport { useCallback, useState } from \"react\";\n\nimport { Tooltip } from \"~/components/deer-flow/tooltip\";\nimport { Button } from \"~/components/ui/button\";\nimport { Switch } from \"~/components/ui/switch\";\nimport { queryMCPServerMetadata } from \"~/core/api\";\nimport type { MCPServerMetadata } from \"~/core/mcp\";\nimport { cn } from \"~/lib/utils\";\n\nimport { AddMCPServerDialog } from \"../dialogs/add-mcp-server-dialog\";\nimport { EditMCPServerDialog } from \"../dialogs/edit-mcp-server-dialog\";\n\nimport type { Tab } from \"./types\";\n\nexport const MCPTab: Tab = ({ settings, onChange }) => {\n  const t = useTranslations(\"settings.mcp\");\n  const [servers, setServers] = useState<MCPServerMetadata[]>(\n    settings.mcp.servers,\n  );\n  const [newlyAdded, setNewlyAdded] = useState(false);\n  const [editingServer, setEditingServer] = useState<MCPServerMetadata | null>(null);\n  const handleAddServers = useCallback(\n    (servers: MCPServerMetadata[]) => {\n      const merged = mergeServers(settings.mcp.servers, servers);\n      setServers(merged);\n      onChange({ ...settings, mcp: { ...settings.mcp, servers: merged } });\n      setNewlyAdded(true);\n      setTimeout(() => {\n        setNewlyAdded(false);\n      }, 1000);\n      setTimeout(() => {\n        document.getElementById(\"settings-content-scrollable\")?.scrollTo({\n          top: 0,\n          behavior: \"smooth\",\n        });\n      }, 100);\n    },\n    [onChange, settings],\n  );\n  const handleDeleteServer = useCallback(\n    (name: string) => {\n      const merged = settings.mcp.servers.filter(\n        (server) => server.name !== name,\n      );\n      setServers(merged);\n      onChange({ ...settings, mcp: { ...settings.mcp, servers: merged } });\n    },\n    [onChange, settings],\n  );\n\n  const handleEditServer = useCallback(async (config: string) => {\n    if (!editingServer) return false;\n\n    try {\n      const parsedConfig = JSON.parse(config) as { mcpServers?: Record<string, MCPServerMetadata> };\n\n      if (!parsedConfig.mcpServers || typeof parsedConfig.mcpServers !== 'object') {\n        console.error('Invalid configuration format: mcpServers not found');\n        return false;\n      }\n\n      const serverEntries = Object.entries(parsedConfig.mcpServers);\n      if (serverEntries.length === 0) {\n        console.error('No server configuration found in mcpServers');\n        return false;\n      }\n\n      const firstEntry = serverEntries[0];\n      if (!firstEntry) {\n        console.error('Failed to get server configuration');\n        return false;\n      }\n\n      const [serverName, serverConfig] = firstEntry;\n\n      // Update the server configuration\n      const updatedServers = settings.mcp.servers.map(server =>\n        server.name === editingServer.name\n          ? {\n            ...server,\n            ...serverConfig,\n            name: serverName, // Allow renaming the server\n            updatedAt: Date.now(),\n          }\n          : server\n      );\n\n      setServers(updatedServers);\n      onChange({ ...settings, mcp: { ...settings.mcp, servers: updatedServers } });\n      return true;\n    } catch (error) {\n      console.error('Failed to update server configuration:', error);\n      return false;\n    }\n  }, [editingServer, onChange, settings]);\n\n  const handleRefreshServers = useCallback(async (serverName?: string) => {\n    try {\n      // Create a new array with the updated server\n      const updatedServers = await Promise.all(\n        settings.mcp.servers.map(async (server) => {\n          // Skip if this is not the server we want to refresh\n          if (serverName && server.name !== serverName) {\n            return server;\n          }\n\n          // Skip disabled servers unless explicitly requested\n          if (!server.enabled && server.name !== serverName) {\n            return server;\n          }\n\n          try {\n            // Get the latest metadata\n            const metadata = await queryMCPServerMetadata(server);\n\n            // Create a new server object with preserved properties\n            return {\n              ...server, // Keep all existing properties\n              ...metadata, // Apply metadata updates\n              name: server.name, // Ensure name is preserved\n              enabled: server.enabled, // Preserve the enabled state\n              createdAt: server.createdAt, // Keep the original creation time\n              updatedAt: Date.now(), // Update the last updated time\n            };\n          } catch (error) {\n            console.error(`Failed to refresh server ${server.name}:`, error);\n            // Return the original server if refresh fails\n            return server;\n          }\n        })\n      );\n\n      // Update the servers list\n      setServers(updatedServers);\n      onChange({ ...settings, mcp: { ...settings.mcp, servers: updatedServers } });\n    } catch (error) {\n      console.error('Failed to refresh MCP servers:', error);\n    }\n  }, [onChange, settings]);\n\n  const handleToggleServer = useCallback(\n    async (name: string, enabled: boolean) => {\n      const merged = settings.mcp.servers.map((server) =>\n        server.name === name ? { ...server, enabled } : server,\n      );\n      setServers(merged);\n      onChange({ ...settings, mcp: { ...settings.mcp, servers: merged } });\n\n      // Refresh server metadata when enabling a server\n      if (enabled) {\n        try {\n          const server = merged.find(s => s.name === name);\n          if (server) {\n            const metadata = await queryMCPServerMetadata(server);\n            const updatedServers = merged.map(s =>\n              s.name === name\n                ? {\n                  ...s,\n                  ...metadata,\n                  name: s.name,\n                  enabled: true,\n                  createdAt: s.createdAt,\n                  updatedAt: Date.now(),\n                }\n                : s\n            );\n            setServers(updatedServers);\n            onChange({ ...settings, mcp: { ...settings.mcp, servers: updatedServers } });\n          }\n        } catch (error) {\n          console.error(`Failed to refresh server ${name}:`, error);\n        }\n      }\n    },\n    [onChange, settings],\n  );\n\n  const animationProps = {\n    initial: { backgroundColor: \"gray\" },\n    animate: { backgroundColor: \"transparent\" },\n    transition: { duration: 1 },\n    style: {\n      transition: \"background-color 1s ease-out\",\n    },\n  };\n  return (\n    <div className=\"flex flex-col gap-4\">\n      <header>\n        <div className=\"flex items-center justify-between gap-2\">\n          <h1 className=\"text-lg font-medium\">{t(\"title\")}</h1>\n          <AddMCPServerDialog onAdd={handleAddServers} />\n        </div>\n        <div className=\"text-muted-foreground markdown text-sm\">\n          {t(\"description\")}\n          <a\n            className=\"ml-1\"\n            target=\"_blank\"\n            href=\"https://modelcontextprotocol.io/\"\n          >\n            {t(\"learnMore\")}\n          </a>\n        </div>\n      </header>\n      <main>\n        <ul id=\"mcp-servers-list\" className=\"flex flex-col gap-4\">\n          {servers.map((server) => {\n            const isNew =\n              server.createdAt &&\n              server.createdAt > Date.now() - 1000 * 60 * 60 * 1;\n            return (\n              <motion.li\n                className={\n                  \"!bg-card group relative overflow-hidden rounded-lg border pb-2 shadow duration-300\"\n                }\n                key={server.name}\n                {...(isNew && newlyAdded && animationProps)}\n              >\n                <div className=\"absolute top-3 right-2\">\n                  <Tooltip title={t(\"enableDisable\")}>\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        id=\"airplane-mode\"\n                        checked={server.enabled}\n                        onCheckedChange={(checked) => {\n                          void handleToggleServer(server.name, checked);\n                        }}\n                      />\n                    </div>\n                  </Tooltip>\n                </div>\n                <div className=\"absolute top-1 right-12 flex gap-1 opacity-0 transition-opacity duration-300 group-hover:opacity-100\">\n                  <Tooltip title={t(\"editServer\")}>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"h-8 w-8\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        setEditingServer(server);\n                      }}\n                    >\n                      <Edit2 className=\"h-4 w-4\" />\n                    </Button>\n                  </Tooltip>\n                  <Tooltip title={t(\"refreshServer\")}>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"h-8 w-8\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        void handleRefreshServers(server.name);\n                      }}\n                    >\n                      <RefreshCw className=\"h-4 w-4\" />\n                    </Button>\n                  </Tooltip>\n                  <Tooltip title={t(\"deleteServer\")}>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"h-8 w-8\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        handleDeleteServer(server.name);\n                      }}\n                    >\n                      <Trash className=\"h-4 w-4\" />\n                    </Button>\n                  </Tooltip>\n                </div>\n                <div\n                  className={cn(\n                    \"flex flex-col items-start px-4 py-2\",\n                    !server.enabled && \"text-muted-foreground\",\n                  )}\n                >\n                  <div\n                    className={cn(\n                      \"mb-2 flex items-center gap-2\",\n                      !server.enabled && \"opacity-70\",\n                    )}\n                  >\n                    <div className=\"text-lg font-medium\">{server.name}</div>\n                    {!server.enabled && (\n                      <div className=\"bg-primary text-primary-foreground h-fit rounded px-1.5 py-0.5 text-xs\">\n                        {t(\"disabled\")}\n                      </div>\n                    )}\n                    <div className=\"bg-primary text-primary-foreground h-fit rounded px-1.5 py-0.5 text-xs\">\n                      {server.transport}\n                    </div>\n                    {isNew && (\n                      <div className=\"bg-primary text-primary-foreground h-fit rounded px-1.5 py-0.5 text-xs\">\n                        {t(\"new\")}\n                      </div>\n                    )}\n                  </div>\n                  <ul\n                    className={cn(\n                      \"flex flex-wrap items-center gap-2\",\n                      !server.enabled && \"opacity-70\",\n                    )}\n                  >\n                    <PencilRuler size={16} />\n                    {server.tools.map((tool) => (\n                      <li\n                        key={tool.name}\n                        className=\"text-muted-foreground border-muted-foreground w-fit rounded-md border px-2\"\n                      >\n                        <Tooltip key={tool.name} title={tool.description}>\n                          <div className=\"w-fit text-sm\">{tool.name}</div>\n                        </Tooltip>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              </motion.li>\n            );\n          })}\n        </ul>\n      </main>\n      {editingServer && (\n        <EditMCPServerDialog\n          server={editingServer}\n          open={!!editingServer}\n          onOpenChange={(open) => !open && setEditingServer(null)}\n          onSave={async (config) => {\n            const success = await handleEditServer(config);\n            if (success) {\n              setEditingServer(null);\n            }\n            return success;\n          }}\n        />\n      )}\n    </div>\n  );\n};\nMCPTab.icon = Blocks;\nMCPTab.displayName = \"MCP\";\nMCPTab.badge = \"Beta\";\nMCPTab.displayName = \"MCP\";\n\nfunction mergeServers(\n  existing: MCPServerMetadata[],\n  added: MCPServerMetadata[],\n): MCPServerMetadata[] {\n  const serverMap = new Map(existing.map((server) => [server.name, server]));\n\n  for (const addedServer of added) {\n    addedServer.createdAt = Date.now();\n    addedServer.updatedAt = Date.now();\n    serverMap.set(addedServer.name, addedServer);\n  }\n\n  const result = Array.from(serverMap.values());\n  result.sort((a, b) => b.createdAt - a.createdAt);\n  return result;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5209, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/settings/tabs/index.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { Settings, type LucideIcon } from \"lucide-react\";\n\nimport { AboutTab } from \"./about-tab\";\nimport { GeneralTab } from \"./general-tab\";\nimport { MCPTab } from \"./mcp-tab\";\n\nexport const SETTINGS_TABS = [GeneralTab, MCPTab, AboutTab].map((tab) => {\n  const name = tab.displayName ?? tab.name;\n  return {\n    ...tab,\n    id: name.replace(/Tab$/, \"\").toLocaleLowerCase(),\n    label: name.replace(/Tab$/, \"\"),\n    icon: (tab.icon ?? <Settings />) as LucideIcon,\n    component: tab,\n  };\n});\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;AAE/B;AAEA;AACA;AACA;;;;;;AAEO,MAAM,gBAAgB;IAAC,oJAAA,CAAA,aAAU;IAAE,gJAAA,CAAA,SAAM;IAAE,kJAAA,CAAA,WAAQ;CAAC,CAAC,GAAG,MAAC,CAAC;QAClD;IAAb,MAAM,OAAO,CAAA,mBAAA,IAAI,WAAW,cAAf,8BAAA,mBAAmB,IAAI,IAAI;QAK/B;IAJT,OAAO;QACL,GAAG,GAAG;QACN,IAAI,KAAK,OAAO,CAAC,QAAQ,IAAI,iBAAiB;QAC9C,OAAO,KAAK,OAAO,CAAC,QAAQ;QAC5B,MAAO,CAAA,YAAA,IAAI,IAAI,cAAR,uBAAA,0BAAY,sYAAC,iSAAA,CAAA,WAAQ;;;;;QAC5B,WAAW;IACb;AACF","debugId":null}},
    {"offset": {"line": 5257, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/settings/dialogs/settings-dialog.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\nimport { Settings } from \"lucide-react\";\nimport { useTranslations } from 'next-intl';\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\n\nimport { Tooltip } from \"~/components/deer-flow/tooltip\";\nimport { Badge } from \"~/components/ui/badge\";\nimport { Button } from \"~/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\";\nimport { Tabs, TabsContent } from \"~/components/ui/tabs\";\nimport { useReplay } from \"~/core/replay\";\nimport {\n  type SettingsState,\n  changeSettings,\n  saveSettings,\n  useSettingsStore,\n} from \"~/core/store\";\nimport { cn } from \"~/lib/utils\";\n\nimport { SETTINGS_TABS } from \"../tabs\";\n\nexport function SettingsDialog() {\n  const t = useTranslations('settings');\n  const tCommon = useTranslations('common');\n  const { isReplay } = useReplay();\n  const [activeTabId, setActiveTabId] = useState(SETTINGS_TABS[0]!.id);\n  const [open, setOpen] = useState(false);\n  const [settings, setSettings] = useState(useSettingsStore.getState());\n  const [changes, setChanges] = useState<Partial<SettingsState>>({});\n\n  const handleTabChange = useCallback(\n    (newChanges: Partial<SettingsState>) => {\n      setTimeout(() => {\n        if (open) {\n          setChanges((prev) => ({\n            ...prev,\n            ...newChanges,\n          }));\n        }\n      }, 0);\n    },\n    [open],\n  );\n\n  const handleSave = useCallback(() => {\n    if (Object.keys(changes).length > 0) {\n      const newSettings: SettingsState = {\n        ...settings,\n        ...changes,\n      };\n      setSettings(newSettings);\n      setChanges({});\n      changeSettings(newSettings);\n      saveSettings();\n    }\n    setOpen(false);\n  }, [settings, changes]);\n\n  const handleOpen = useCallback(() => {\n    setSettings(useSettingsStore.getState());\n  }, []);\n\n  const handleClose = useCallback(() => {\n    setChanges({});\n  }, []);\n\n  useEffect(() => {\n    if (open) {\n      handleOpen();\n    } else {\n      handleClose();\n    }\n  }, [open, handleOpen, handleClose]);\n\n  const mergedSettings = useMemo<SettingsState>(() => {\n    return {\n      ...settings,\n      ...changes,\n    };\n  }, [settings, changes]);\n\n  if (isReplay) {\n    return null;\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <Tooltip title={tCommon('settings')}>\n        <DialogTrigger asChild>\n          <Button variant=\"ghost\" size=\"icon\">\n            <Settings />\n          </Button>\n        </DialogTrigger>\n      </Tooltip>\n      <DialogContent className=\"sm:max-w-[850px]\">\n        <DialogHeader>\n          <DialogTitle>{t('title')}</DialogTitle>\n          <DialogDescription>\n            {t('description')}\n          </DialogDescription>\n        </DialogHeader>\n        <Tabs value={activeTabId}>\n          <div className=\"flex h-120 w-full overflow-auto border-y\">\n            <ul className=\"flex w-50 shrink-0 border-r p-1\">\n              <div className=\"size-full\">\n                {SETTINGS_TABS.map((tab) => (\n                  <li\n                    key={tab.id}\n                    className={cn(\n                      \"hover:accent-foreground hover:bg-accent mb-1 flex h-8 w-full cursor-pointer items-center gap-1.5 rounded px-2\",\n                      activeTabId === tab.id &&\n                        \"!bg-primary !text-primary-foreground\",\n                    )}\n                    onClick={() => setActiveTabId(tab.id)}\n                  >\n                    <tab.icon size={16} />\n                    <span>{tab.label}</span>\n                    {tab.badge && (\n                      <Badge\n                        variant=\"outline\"\n                        className={cn(\n                          \"border-muted-foreground text-muted-foreground ml-auto px-1 py-0 text-xs\",\n                          activeTabId === tab.id &&\n                            \"border-primary-foreground text-primary-foreground\",\n                        )}\n                      >\n                        {tab.badge}\n                      </Badge>\n                    )}\n                  </li>\n                ))}\n              </div>\n            </ul>\n            <div className=\"min-w-0 flex-grow\">\n              <div\n                id=\"settings-content-scrollable\"\n                className=\"size-full overflow-auto p-4\"\n              >\n                {SETTINGS_TABS.map((tab) => (\n                  <TabsContent key={tab.id} value={tab.id}>\n                    <tab.component\n                      settings={mergedSettings}\n                      onChange={handleTabChange}\n                    />\n                  </TabsContent>\n                ))}\n              </div>\n            </div>\n          </div>\n        </Tabs>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => setOpen(false)}>\n            {tCommon('cancel')}\n          </Button>\n          <Button className=\"w-24\" type=\"submit\" onClick={handleSave}>\n            {tCommon('save')}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5581, "column": 0}, "map": {"version":3,"sources":["file:///Users/ouyangsihao/code/python/deer/web/src/app/chat/page.tsx"],"sourcesContent":["// Copyright (c) 2025 Bytedance Ltd. and/or its affiliates\n// SPDX-License-Identifier: MIT\n\n\"use client\";\n\nimport { GithubOutlined } from \"@ant-design/icons\";\nimport dynamic from \"next/dynamic\";\nimport { useTheme } from \"next-themes\";\nimport Link from \"next/link\";\nimport { useTranslations } from \"next-intl\";\nimport { Suspense } from \"react\";\n\nimport { Button } from \"~/components/ui/button\";\nimport { cn } from \"~/lib/utils\";\n\nimport { Logo } from \"../../components/deer-flow/logo\";\nimport { ThemeToggle } from \"../../components/deer-flow/theme-toggle\";\nimport { Tooltip } from \"../../components/deer-flow/tooltip\";\nimport { SettingsDialog } from \"../settings/dialogs/settings-dialog\";\n\nconst Main = dynamic(() => import(\"./main\"), {\n  ssr: false,\n  loading: () => (\n    <div className=\"flex h-full w-full items-center justify-center\">\n      Loading DeerFlow...\n    </div>\n  ),\n});\n\nexport default function HomePage() {\n  const t = useTranslations(\"chat.page\");\n  const { resolvedTheme = \"dark\" } = useTheme();\n\n  return (\n    <div\n      className={cn(\n        \"flex h-screen w-screen justify-center overscroll-none\",\n        resolvedTheme === \"light\" ? \"bg-white text-black\" : \"bg-black text-white\",\n      )}\n    >\n      <header className=\"fixed top-0 left-0 flex h-12 w-full items-center justify-between px-4\">\n        <Logo />\n        <div className=\"flex items-center\">\n          <Tooltip title={t(\"starOnGitHub\")}>\n            <Button variant=\"ghost\" size=\"icon\" asChild>\n              <Link\n                href=\"https://github.com/bytedance/deer-flow\"\n                target=\"_blank\"\n              >\n                <GithubOutlined />\n              </Link>\n            </Button>\n          </Tooltip>\n          <ThemeToggle />\n          <Suspense>\n            <SettingsDialog />\n          </Suspense>\n        </div>\n      </header>\n      <Main />\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,+BAA+B;;;;;AAI/B;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;;;;AAfA;;;;;;;;;;;;;AAiBA,MAAM,OAAO,CAAA,GAAA,2WAAA,CAAA,UAAO,AAAD,EAAE;;;;;;IACnB,KAAK;IACL,SAAS,kBACP,sYAAC;YAAI,WAAU;sBAAiD;;;;;;;KAH9D;AASS,SAAS;;IACtB,MAAM,IAAI,CAAA,GAAA,8ZAAA,CAAA,kBAAe,AAAD,EAAE;IAC1B,MAAM,EAAE,gBAAgB,MAAM,EAAE,GAAG,CAAA,GAAA,2RAAA,CAAA,WAAQ,AAAD;IAE1C,qBACE,sYAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,yDACA,kBAAkB,UAAU,wBAAwB;;0BAGtD,sYAAC;gBAAO,WAAU;;kCAChB,sYAAC,6IAAA,CAAA,OAAI;;;;;kCACL,sYAAC;wBAAI,WAAU;;0CACb,sYAAC,gJAAA,CAAA,UAAO;gCAAC,OAAO,EAAE;0CAChB,cAAA,sYAAC,qIAAA,CAAA,SAAM;oCAAC,SAAQ;oCAAQ,MAAK;oCAAO,OAAO;8CACzC,cAAA,sYAAC,wWAAA,CAAA,UAAI;wCACH,MAAK;wCACL,QAAO;kDAEP,cAAA,sYAAC,2WAAA,CAAA,iBAAc;;;;;;;;;;;;;;;;;;;;0CAIrB,sYAAC,wJAAA,CAAA,cAAW;;;;;0CACZ,sYAAC,sWAAA,CAAA,WAAQ;0CACP,cAAA,sYAAC,2JAAA,CAAA,iBAAc;;;;;;;;;;;;;;;;;;;;;;0BAIrB,sYAAC;;;;;;;;;;;AAGP;GAjCwB;;QACZ,8ZAAA,CAAA,kBAAe;QACU,2RAAA,CAAA,WAAQ;;;MAFrB","debugId":null}}]
}